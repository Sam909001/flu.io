<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FLUFFI Wallet Connection</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
    
    * {
      font-family: 'Poppins', sans-serif;
    }
    
    .wallet-modal {
      display: none;
      position: fixed;
      z-index: 100;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(5px);
      align-items: center;
      justify-content: center;
    }
    
    .wallet-modal.active {
      display: flex;
    }
    
    .wallet-modal-content {
      background-color: white;
      border-radius: 16px;
      width: 90%;
      max-width: 400px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
      overflow: hidden;
    }
    
    .dark .wallet-modal-content {
      background-color: #1f2937;
    }
    
    .wallet-header {
      background: linear-gradient(90deg, #10b981 0%, #059669 100%);
      color: white;
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .wallet-close {
      font-size: 24px;
      cursor: pointer;
      transition: transform 0.2s;
    }
    
    .wallet-close:hover {
      transform: scale(1.1);
    }
    
    .wallet-options {
      padding: 20px;
    }
    
    .wallet-option {
      display: flex;
      align-items: center;
      padding: 15px;
      margin-bottom: 12px;
      border-radius: 12px;
      background-color: #f9fafb;
      cursor: pointer;
      transition: all 0.2s;
      border: 1px solid #e5e7eb;
    }
    
    .dark .wallet-option {
      background-color: #374151;
      border-color: #4b5563;
    }
    
    .wallet-option:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      background-color: #e6fffa;
    }
    
    .dark .wallet-option:hover {
      background-color: #065f46;
    }
    
    .wallet-option img {
      width: 32px;
      height: 32px;
      margin-right: 15px;
    }
    
    .wallet-option span {
      font-weight: 500;
    }
    
    .notification-toast {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      animation: slideIn 0.3s ease-out;
    }
    
    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    
    .notification-toast.slide-out {
      animation: slideOut 0.3s ease-out forwards;
    }
    
    @keyframes slideOut {
      from {
        transform: translateX(0);
        opacity: 1;
      }
      to {
        transform: translateX(100%);
        opacity: 0;
      }
    }
    
    .connected-wallet {
      display: flex;
      align-items: center;
      background: linear-gradient(90deg, #10b981 0%, #059669 100%);
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      font-weight: 500;
    }
    
    .disconnect-btn {
      background-color: #ef4444;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 20px;
      cursor: pointer;
      font-weight: 500;
      margin-left: 10px;
      transition: background-color 0.2s;
    }
    
    .disconnect-btn:hover {
      background-color: #dc2626;
    }
    
    .spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-white min-h-screen flex items-center justify-center p-4">
  <div class="max-w-md w-full bg-white dark:bg-gray-800 rounded-2xl shadow-xl overflow-hidden">
    <!-- Header -->
    <div class="bg-gradient-to-r from-green-500 to-green-600 p-6 text-center">
      <div class="flex items-center justify-center mb-4">
        <img src="https://placeholder.pics/svg/40x40/10B981/FFFFFF/FLUFFI" alt="FLUFFI Logo" class="w-10 h-10 rounded-full mr-3">
        <h1 class="text-3xl font-bold text-white">$FLUFFI</h1>
      </div>
      <p class="text-green-100">Connect your wallet to participate in the presale</p>
    </div>
    
    <!-- Main Content -->
    <div class="p-6">
      <div class="text-center mb-8">
        <h2 class="text-2xl font-bold mb-2">Wallet Connection</h2>
        <p class="text-gray-600 dark:text-gray-300">Select your preferred wallet to connect to FLUFFI</p>
      </div>
      
      <!-- Wallet Connection Status -->
      <div id="connectionStatus" class="hidden p-4 rounded-lg mb-6 text-center">
        <div id="statusIcon" class="text-4xl mb-2"></div>
        <h3 id="statusTitle" class="font-bold text-lg"></h3>
        <p id="statusMessage" class="text-gray-600 dark:text-gray-300"></p>
      </div>
      
      <!-- Wallet Buttons -->
      <div class="flex flex-col space-y-4 mb-6">
        <button id="walletButton" onclick="openWalletModal()" class="bg-green-500 hover:bg-green-600 text-white py-3 px-6 rounded-xl font-semibold text-lg transition-colors flex items-center justify-center">
          <i class="fas fa-wallet mr-3"></i>Connect Wallet
        </button>
        
        <div id="connectedWallet" class="hidden">
          <div class="connected-wallet">
            <i class="fas fa-check-circle mr-2"></i>
            <span id="walletAddressShort">Connected</span>
          </div>
          <button onclick="disconnectWallet()" class="disconnect-btn w-full mt-3">
            Disconnect Wallet
          </button>
        </div>
      </div>
      
      <!-- Network Info -->
      <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
        <h3 class="font-semibold mb-2 flex items-center">
          <i class="fas fa-info-circle text-green-500 mr-2"></i>Supported Networks
        </h3>
        <ul class="text-sm text-gray-600 dark:text-gray-300 space-y-1">
          <li class="flex items-center">
            <span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>
            BNB Smart Chain (BEP-20)
          </li>
          <li class="flex items-center">
            <span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>
            Ethereum (ERC-20)
          </li>
          <li class="flex items-center">
            <span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>
            Polygon (MATIC)
          </li>
        </ul>
      </div>
    </div>
  </div>
  
  <!-- Wallet Modal -->
  <div id="walletModal" class="wallet-modal">
    <div class="wallet-modal-content">
      <div class="wallet-header">
        <h3 class="text-xl font-bold">Connect Wallet</h3>
        <span class="wallet-close" onclick="closeWalletModal()">&times;</span>
      </div>
      <div class="wallet-options">
        <div class="wallet-option" onclick="connectWallet('metamask')">
          <img src="https://upload.wikimedia.org/wikipedia/commons/3/36/MetaMask_Fox.svg" alt="MetaMask">
          <span>MetaMask</span>
        </div>
        <div class="wallet-option" onclick="connectWallet('walletconnect')">
          <img src="https://docs.walletconnect.com/img/walletconnect-logo.svg" alt="WalletConnect">
          <span>WalletConnect</span>
        </div>
        <div class="wallet-option" onclick="connectWallet('trustwallet')">
          <img src="https://trustwallet.com/assets/images/media/assets/TWT.png" alt="Trust Wallet">
          <span>Trust Wallet</span>
        </div>
        <div class="wallet-option" onclick="connectWallet('binance')">
          <img src="https://bin.bnbstatic.com/image/binance-coin-logo.png" alt="Binance Chain Wallet">
          <span>Binance Chain Wallet</span>
        </div>
        <div class="wallet-option" onclick="connectWallet('coinbase')">
          <img src="https://cdn.iconscout.com/icon/free/png-256/coinbase-3-1174883.png" alt="Coinbase Wallet">
          <span>Coinbase Wallet</span>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Global variables
    let userWalletAddress = null;
    let connectedChainId = null;
    
    // DOM elements
    const walletModal = document.getElementById('walletModal');
    const walletButton = document.getElementById('walletButton');
    const connectedWallet = document.getElementById('connectedWallet');
    const walletAddressShort = document.getElementById('walletAddressShort');
    const connectionStatus = document.getElementById('connectionStatus');
    const statusIcon = document.getElementById('statusIcon');
    const statusTitle = document.getElementById('statusTitle');
    const statusMessage = document.getElementById('statusMessage');
    
    // Check if user was previously connected
    document.addEventListener('DOMContentLoaded', function() {
      const savedAddress = localStorage.getItem('walletAddress');
      if (savedAddress) {
        userWalletAddress = savedAddress;
        updateWalletUI();
      }
    });
    
    // Wallet modal functions
    function openWalletModal() {
      walletModal.classList.add('active');
    }
    
    function closeWalletModal() {
      walletModal.classList.remove('active');
    }
    
    // Close modal when clicking outside
    window.addEventListener('click', function(event) {
      if (event.target === walletModal) {
        closeWalletModal();
      }
    });
    
    // Main wallet connection function
    async function connectWallet(walletType) {
      closeWalletModal();
      
      // Show connecting status
      showStatus('loading', 'Connecting...', 'Please approve the connection in your wallet');
      
      try {
        let address;
        
        switch(walletType) {
          case 'metamask':
            address = await connectMetaMask();
            break;
          case 'walletconnect':
            address = await connectWalletConnect();
            break;
          case 'trustwallet':
            address = await connectTrustWallet();
            break;
          case 'binance':
            address = await connectBinanceWallet();
            break;
          case 'coinbase':
            address = await connectCoinbaseWallet();
            break;
          default:
            throw new Error('Unknown wallet type');
        }
        
        // Success
        userWalletAddress = address;
        localStorage.setItem('walletAddress', address);
        updateWalletUI();
        showStatus('success', 'Connected successfully', `Your wallet is now connected to FLUFFI`);
        
      } catch (error) {
        console.error('Connection error:', error);
        showStatus('error', 'Connection failed', error.message || 'Please try again');
      }
    }
    
    // MetaMask connection
    async function connectMetaMask() {
      if (typeof window.ethereum === 'undefined') {
        throw new Error('Please install MetaMask to continue');
      }
      
      // Request account access
      const accounts = await window.ethereum.request({
        method: 'eth_requestAccounts'
      });
      
      // Get chain ID
      connectedChainId = await window.ethereum.request({ method: 'eth_chainId' });
      
      // Set up listeners
      window.ethereum.on('accountsChanged', handleAccountsChanged);
      window.ethereum.on('chainChanged', handleChainChanged);
      
      return accounts[0];
    }
    
    // WalletConnect connection (simulated for demo)
    async function connectWalletConnect() {
      // Simulate WalletConnect connection process
      await new Promise(resolve => setTimeout(resolve, 1500));
      
      // For demo purposes, generate a random address
      const randomAddress = '0x' + Math.random().toString(16).slice(2, 42);
      return randomAddress;
    }
    
    // Trust Wallet connection (similar to MetaMask)
    async function connectTrustWallet() {
      if (typeof window.ethereum === 'undefined') {
        throw new Error('Please install Trust Wallet to continue');
      }
      
      // Trust Wallet uses the same API as MetaMask
      const accounts = await window.ethereum.request({
        method: 'eth_requestAccounts'
      });
      
      connectedChainId = await window.ethereum.request({ method: 'eth_chainId' });
      
      window.ethereum.on('accountsChanged', handleAccountsChanged);
      window.ethereum.on('chainChanged', handleChainChanged);
      
      return accounts[0];
    }
    
    // Binance Chain Wallet connection
    async function connectBinanceWallet() {
      if (typeof window.BinanceChain === 'undefined') {
        throw new Error('Please install Binance Chain Wallet to continue');
      }
      
      const accounts = await window.BinanceChain.request({
        method: 'eth_requestAccounts'
      });
      
      connectedChainId = await window.BinanceChain.request({ method: 'eth_chainId' });
      
      window.BinanceChain.on('accountsChanged', handleAccountsChanged);
      window.BinanceChain.on('chainChanged', handleChainChanged);
      
      return accounts[0];
    }
    
    // Coinbase Wallet connection (simulated for demo)
    async function connectCoinbaseWallet() {
      // Simulate Coinbase Wallet connection process
      await new Promise(resolve => setTimeout(resolve, 1500));
      
      // For demo purposes, generate a random address
      const randomAddress = '0x' + Math.random().toString(16).slice(2, 42);
      return randomAddress;
    }
    
    // Handle account changes
    function handleAccountsChanged(accounts) {
      if (accounts.length === 0) {
        // User disconnected their wallet
        disconnectWallet();
        showStatus('info', 'Wallet disconnected', 'You have disconnected your wallet');
      } else if (accounts[0] !== userWalletAddress) {
        // User switched accounts
        userWalletAddress = accounts[0];
        localStorage.setItem('walletAddress', userWalletAddress);
        updateWalletUI();
        showStatus('info', 'Account changed', 'Switched to a different account');
      }
    }
    
    // Handle chain changes
    function handleChainChanged(chainId) {
      connectedChainId = chainId;
      showStatus('info', 'Network changed', 'You have switched networks');
      // You might want to check if the chain is supported here
    }
    
    // Disconnect wallet
    function disconnectWallet() {
      userWalletAddress = null;
      connectedChainId = null;
      localStorage.removeItem('walletAddress');
      updateWalletUI();
    }
    
    // Update UI based on connection status
    function updateWalletUI() {
      if (userWalletAddress) {
        // Format address for display
        const shortAddress = `${userWalletAddress.substring(0, 6)}...${userWalletAddress.substring(userWalletAddress.length - 4)}`;
        walletAddressShort.textContent = shortAddress;
        
        // Show connected state
        walletButton.classList.add('hidden');
        connectedWallet.classList.remove('hidden');
      } else {
        // Show disconnected state
        walletButton.classList.remove('hidden');
        connectedWallet.classList.add('hidden');
      }
    }
    
    // Show status message
    function showStatus(type, title, message) {
      // Set icon and colors based on type
      let iconClass, bgColor, textColor;
      
      switch(type) {
        case 'loading':
          iconClass = 'fas fa-spinner fa-spin';
          bgColor = 'bg-blue-100';
          textColor = 'text-blue-800';
          break;
        case 'success':
          iconClass = 'fas fa-check-circle';
          bgColor = 'bg-green-100';
          textColor = 'text-green-800';
          break;
        case 'error':
          iconClass = 'fas fa-exclamation-circle';
          bgColor = 'bg-red-100';
          textColor = 'text-red-800';
          break;
        case 'info':
          iconClass = 'fas fa-info-circle';
          bgColor = 'bg-blue-100';
          textColor = 'text-blue-800';
          break;
      }
      
      // Update status element
      statusIcon.className = iconClass;
      statusTitle.textContent = title;
      statusMessage.textContent = message;
      
      connectionStatus.classList.remove('hidden');
      connectionStatus.className = `p-4 rounded-lg mb-6 text-center ${bgColor} ${textColor}`;
      
      // Auto-hide success messages after 5 seconds
      if (type === 'success') {
        setTimeout(() => {
          connectionStatus.classList.add('hidden');
        }, 5000);
      }
    }
  </script>
</body>
</html>
