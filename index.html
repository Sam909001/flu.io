<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>$FLUFFI Presale & Staking</title>
  <meta name="description" content="$FLUFFI is a Solana Layer 2 meme token with presale and staking features. Join the community and earn rewards." />
  <meta name="keywords" content="Fluffi, $FLUFFI, crypto, presale, staking, Solana, meme token" />
  <meta name="author" content="FLUFFI Team" />
  
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üêæ</text></svg>" type="image/svg+xml">
  
  <!-- Tailwind CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
  
  <!-- Ethers.js v6 -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.7.0/dist/ethers.umd.min.js"></script>
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root {
      --primary-green: #10b981;
      --primary-red: #ef4444;
      --dark-bg: #0f172a;
      --dark-card: #1e293b;
    }

    body {
      background: linear-gradient(to bottom, #fff0f5, #fff9e6);
      color: #1a1a1a;
      transition: all 0.3s ease;
    }

    /* Dark mode styles */
    .dark {
      background: linear-gradient(to bottom, var(--dark-bg), var(--dark-card)) !important;
      color: #f0f0f0 !important;
    }

    .dark .bg-white {
      background-color: var(--dark-card) !important;
      color: #f0f0f0 !important;
    }

    .dark .text-gray-600,
    .dark .text-gray-500,
    .dark .text-gray-700 {
      color: #d1d5db !important;
    }

    .dark .bg-gray-200,
    .dark .bg-gray-100 {
      background-color: #374151 !important;
      color: #f0f0f0 !important;
    }

    .dark .border-gray-200,
    .dark .border-gray-300 {
      border-color: #4b5563 !important;
    }

    .dark .text-blue-600 {
      color: #60a5fa !important;
    }

    .dark h1, .dark h2, .dark h3, .dark h4,
    .dark p, .dark span, .dark div, .dark li,
    .dark summary, .dark label, .dark .timer,
    .dark .stage-label, .dark .font-mono,
    .dark .font-bold, .dark .font-semibold {
      color: #f0f0f9 !important;
    }

    /* Timer animation */
    @keyframes pulse-glow {
      0%, 100% { 
        text-shadow: 0 0 5px rgba(239, 68, 68, 0.5);
      }
      50% { 
        text-shadow: 0 0 20px rgba(239, 68, 68, 0.8), 0 0 30px rgba(239, 68, 68, 0.6);
      }
    }

    .timer-glow {
      animation: pulse-glow 2s ease-in-out infinite;
    }

    /* Logo animation */
    .logo-animate {
      animation: fluffi-float 3s ease-in-out infinite;
    }

    @keyframes fluffi-float {
      0%, 100% { 
        transform: translateY(0) scale(1) rotate(0deg); 
      }
      50% { 
        transform: translateY(-15px) scale(1.05) rotate(2deg); 
      }
    }

    /* Progress bar styling */
    .progress-bar {
      width: 100%;
      height: 12px;
      background: #f0f0f0;
      border-radius: 6px;
      overflow: hidden;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
    }

    .dark .progress-bar {
      background: #374151;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary-green), #059669);
      transition: width 0.5s ease;
      box-shadow: 0 0 10px rgba(16, 185, 129, 0.4);
    }

    /* Button styles */
    .btn-primary {
      background: var(--primary-green);
      color: white;
      padding: 12px 24px;
      border-radius: 8px;
      border: none;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
    }

    .btn-primary:hover {
      background: #059669;
      transform: translateY(-1px);
      box-shadow: 0 6px 16px rgba(16, 185, 129, 0.4);
    }

    .btn-secondary {
      background: #6b7280;
      color: white;
      padding: 8px 16px;
      border-radius: 6px;
      border: none;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-secondary:hover {
      background: #4b5563;
    }

    .btn-danger {
      background: var(--primary-red);
      color: white;
      padding: 8px 16px;
      border-radius: 6px;
      border: none;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-danger:hover {
      background: #dc2626;
    }

    /* Card styles */
    .card {
      background: white;
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
    }

    .dark .card {
      background: var(--dark-card);
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
    }

    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
    }

    /* Input styles */
    .input {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      font-size: 16px;
      transition: all 0.3s ease;
      background: white;
      color: #1a1a1a;
    }

    .input:focus {
      outline: none;
      border-color: var(--primary-green);
      box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
    }

    .dark .input {
      background: #374151;
      border-color: #4b5563;
      color: #f0f0f0;
    }

    .dark .input:focus {
      border-color: var(--primary-green);
    }

    /* Select styles */
    .select {
      padding: 12px 16px;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      background: white;
      color: #1a1a1a;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .dark .select {
      background: #374151;
      border-color: #4b5563;
      color: #f0f0f0;
    }

    /* Tab styles */
    .tab-list {
      display: flex;
      background: #f3f4f6;
      border-radius: 8px;
      padding: 4px;
      margin-bottom: 24px;
    }

    .dark .tab-list {
      background: #374151;
    }

    .tab {
      flex: 1;
      padding: 12px 16px;
      border-radius: 6px;
      border: none;
      background: transparent;
      color: #6b7280;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 500;
    }

    .tab.active {
      background: white;
      color: var(--primary-green);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .dark .tab.active {
      background: var(--dark-card);
      color: var(--primary-green);
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    /* Alert styles */
    .alert {
      padding: 12px 16px;
      border-radius: 8px;
      margin-bottom: 16px;
      border-left: 4px solid var(--primary-green);
      background: #ecfdf5;
      color: #065f46;
    }

    .dark .alert {
      background: #14532d;
      color: #86efac;
    }

    /* Badge styles */
    .badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
    }

    .badge-live {
      background: var(--primary-red);
      color: white;
      animation: pulse 2s infinite;
    }

    .badge-connected {
      background: #dcfce7;
      color: #16a34a;
    }

    .dark .badge-connected {
      background: #14532d;
      color: #86efac;
    }

    /* Modal styles */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal-content {
      background: white;
      border-radius: 12px;
      padding: 24px;
      max-width: 400px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .dark .modal-content {
      background: var(--dark-card);
      color: white;
    }

    .wallet-option {
      display: flex;
      align-items: center;
      padding: 12px 16px;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      margin-bottom: 8px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .wallet-option:hover {
      background: #f3f4f6;
      border-color: var(--primary-green);
    }

    .dark .wallet-option {
      border-color: #4b5563;
      background: #374151;
    }

    .dark .wallet-option:hover {
      background: #4b5563;
      border-color: var(--primary-green);
    }

    .wallet-icon {
      width: 32px;
      height: 32px;
      margin-right: 12px;
      border-radius: 50%;
    }

    /* FAQ styles */
    .faq-item {
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      margin-bottom: 8px;
      overflow: hidden;
    }

    .dark .faq-item {
      border-color: #4b5563;
    }

    .faq-header {
      padding: 16px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
      background: #f9fafb;
      transition: all 0.3s ease;
    }

    .dark .faq-header {
      background: #374151;
    }

    .faq-header:hover {
      background: #f3f4f6;
    }

    .dark .faq-header:hover {
      background: #4b5563;
    }

    .faq-content {
      padding: 0 16px;
      max-height: 0;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .faq-content.active {
      padding: 16px;
      max-height: 200px;
    }

    .faq-arrow {
      transition: transform 0.3s ease;
    }

    .faq-arrow.active {
      transform: rotate(180deg);
    }

    /* Responsive */
    @media (max-width: 768px) {
      .container {
        padding: 0 16px;
      }

      .grid-2 {
        grid-template-columns: 1fr;
      }

      .flex-responsive {
        flex-direction: column;
        gap: 16px;
      }

      .card {
        padding: 16px;
      }
    }

    /* Utility classes */
    .hidden { display: none !important; }
    .flex { display: flex; }
    .grid { display: grid; }
    .grid-2 { grid-template-columns: 1fr 1fr; }
    .gap-4 { gap: 16px; }
    .gap-8 { gap: 32px; }
    .container { max-width: 1200px; margin: 0 auto; padding: 0 24px; }
    .text-center { text-align: center; }
    .text-right { text-align: right; }
    .font-bold { font-weight: 700; }
    .font-semibold { font-weight: 600; }
    .text-sm { font-size: 14px; }
    .text-lg { font-size: 18px; }
    .text-xl { font-size: 20px; }
    .text-2xl { font-size: 24px; }
    .text-3xl { font-size: 30px; }
    .text-4xl { font-size: 36px; }
    .mb-2 { margin-bottom: 8px; }
    .mb-4 { margin-bottom: 16px; }
    .mb-6 { margin-bottom: 24px; }
    .mb-8 { margin-bottom: 32px; }
    .mt-4 { margin-top: 16px; }
    .mt-6 { margin-top: 24px; }
    .p-4 { padding: 16px; }
    .p-6 { padding: 24px; }
    .sticky { position: sticky; }
    .top-0 { top: 0; }
    .z-50 { z-index: 50; }
    .shadow-lg { box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
    .rounded-lg { border-radius: 8px; }
    .rounded-full { border-radius: 50%; }
    .w-full { width: 100%; }
    .h-full { height: 100%; }
    .max-w-md { max-width: 448px; }
    .max-w-lg { max-width: 512px; }
    .max-w-2xl { max-width: 672px; }
    .max-w-4xl { max-width: 896px; }
    .mx-auto { margin-left: auto; margin-right: auto; }
    .items-center { align-items: center; }
    .justify-between { justify-content: space-between; }
    .justify-center { justify-content: center; }
    .space-y-4 > * + * { margin-top: 16px; }
    .space-y-6 > * + * { margin-top: 24px; }
    .fixed { position: fixed; }
    .bottom-4 { bottom: 16px; }
    .right-4 { right: 16px; }
  </style>
</head>

<body>
  <!-- Header -->
  <header class="sticky top-0 z-50 shadow-lg" style="background: #10b981;">
    <div class="container">
      <div class="flex items-center justify-between p-4 flex-responsive">
        <div class="flex items-center gap-4">
          <div class="w-12 h-12 bg-white rounded-full flex items-center justify-center text-2xl logo-animate">üêæ</div>
          <h1 class="text-4xl font-bold text-white">$FLUFFI</h1>
        </div>
        
        <nav class="flex items-center gap-4 flex-wrap">
          <a href="#presale" class="text-white hover:underline">Presale</a>
          <a href="#staking" class="text-white hover:underline">Staking</a>
          <a href="#faq" class="text-white hover:underline">FAQ</a>
          <a href="#tokenomics" class="text-white hover:underline">Tokenomics</a>
          
          <button onclick="toggleDarkMode()" class="btn-secondary">
            <span id="themeIcon">üåô</span>
          </button>
          
          <button onclick="openWalletModal()" id="walletButton" class="btn-primary">
            Connect Wallet
          </button>
          
          <span id="walletAddress" class="badge badge-connected hidden"></span>
          
          <button onclick="disconnectWallet()" id="disconnectButton" class="btn-danger hidden">
            Disconnect
          </button>
        </nav>
      </div>
    </div>
  </header>

  <main class="container space-y-8 p-6">
    <!-- Error/Success Messages -->
    <div id="messageContainer"></div>

    <!-- Timer Section -->
    <div class="card max-w-2xl mx-auto text-center">
      <h3 class="text-2xl font-bold mb-6">üöÄ PRESALE ENDS IN:</h3>
      <div id="presale-timer" class="text-4xl font-mono timer-glow mb-6" style="color: #ef4444;">
        <span id="presale-minutes">15</span>:<span id="presale-seconds">00</span>
      </div>
      
      <div class="mb-6">
        <h4 class="text-lg font-semibold mb-4">Current Stage Progress</h4>
        
        <div class="progress-bar mb-4">
          <div id="stageProgressBar" class="progress-fill" style="width: 0%"></div>
        </div>

        <div class="flex justify-between text-sm">
          <span>Stage: <span id="current-stage">1</span>/15</span>
          <span>Progress: <span id="stage-progress-text">0.0</span>%</span>
        </div>
      </div>

      <div class="grid grid-2 gap-4 text-center">
        <div>
          <div class="text-sm text-gray-600">Current Price</div>
          <div id="currentPrice" class="text-2xl font-bold" style="color: #10b981;">$0.000100</div>
        </div>
        <div>
          <div class="text-sm text-gray-600">Tokens Sold</div>
          <div id="tokensSold" class="text-2xl font-bold">67,431,509</div>
        </div>
      </div>
    </div>

    <!-- Main Content Tabs -->
    <div class="max-w-2xl mx-auto">
      <div class="tab-list">
        <button class="tab active" onclick="switchTab('presale')">Presale</button>
        <button class="tab" onclick="switchTab('staking')">Staking</button>
        <button class="tab" onclick="switchTab('referral')">Referral</button>
        <button class="tab" onclick="switchTab('claim')">Claim</button>
      </div>

      <!-- Presale Tab -->
      <div id="presale-tab" class="tab-content active">
        <div class="card max-w-md mx-auto">
          <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
            üöÄ Buy FLUFFI
            <span class="badge badge-live">LIVE</span>
          </h2>
          
          <div class="alert">
            üéØ Referral Bonus: <strong>10%</strong>
          </div>
          
          <div class="space-y-4">
            <div class="flex gap-2">
              <input type="number" placeholder="Amount" id="amountInput" class="input flex-1" />
              <select id="currencySelect" class="select" style="min-width: 80px;">
                <option value="BNB">BNB</option>
                <option value="USD">USD</option>
              </select>
            </div>
            
            <input type="text" placeholder="Referral wallet (optional)" id="refInput" class="input" />
            
            <button onclick="buyFluffi()" id="buyButton" class="btn-primary w-full">
              üöÄ Buy Now
            </button>
          </div>
        </div>
      </div>

      <!-- Staking Tab -->
      <div id="staking-tab" class="tab-content">
        <div class="card max-w-md mx-auto">
          <h2 class="text-xl font-bold mb-4">üìà Stake Your FLUFFI</h2>
          
          <div class="alert">
            APY: <strong>90%</strong> | Ends at Listing Date
          </div>
          
          <div class="space-y-4">
            <input type="number" placeholder="Amount to stake" id="stakeInput" class="input" />
            
            <button onclick="stakeFluffi()" class="btn-primary w-full" style="background: #eab308;">
              Stake Now
            </button>
          </div>
        </div>
      </div>

      <!-- Referral Tab -->
      <div id="referral-tab" class="tab-content">
        <div class="card max-w-lg mx-auto">
          <h2 class="text-xl font-bold mb-4">üí∞ Earn with Referrals</h2>
          
          <div id="referralSection">
            <p class="mb-4">Connect your wallet to access your referral link and start earning!</p>
            <button onclick="connectReferralWallet()" class="btn-primary">
              Connect Wallet for Referrals
            </button>
          </div>
        </div>
      </div>

      <!-- Claim Tab -->
      <div id="claim-tab" class="tab-content">
        <div class="card max-w-md mx-auto">
          <h2 class="text-xl font-bold mb-4">üéÅ Claim FLUFFI</h2>
          
          <p class="mb-4 text-gray-600">
            Once the presale ends, you can claim your purchased tokens here.
          </p>
          
          <button class="btn-primary w-full" disabled style="opacity: 0.5;">
            Claim Tokens (Coming Soon)
          </button>
        </div>
      </div>
    </div>

    <!-- Tokenomics Section -->
    <section id="tokenomics" class="card max-w-4xl mx-auto">
      <h2 class="text-3xl font-bold text-center mb-8">üìä Tokenomics</h2>

      <div class="grid grid-2 gap-8 items-center">
        <div class="space-y-4">
          <div class="flex justify-between">
            <span class="font-semibold">Total Supply:</span>
            <span>10,000,000,000 FLUFFI</span>
          </div>
          <div class="flex justify-between">
            <span class="font-semibold">Presale:</span>
            <span>40%</span>
          </div>
          <div class="flex justify-between">
            <span class="font-semibold">Liquidity:</span>
            <span>30% (Locked)</span>
          </div>
          <div class="flex justify-between">
            <span class="font-semibold">Staking:</span>
            <span>20%</span>
          </div>
          <div class="flex justify-between">
            <span class="font-semibold">Marketing:</span>
            <span>5%</span>
          </div>
          <div class="flex justify-between">
            <span class="font-semibold">Team:</span>
            <span>5% (Locked)</span>
          </div>
        </div>
        
        <div class="flex justify-center">
          <div style="width: 300px; height: 300px;">
            <canvas id="tokenChart"></canvas>
          </div>
        </div>
      </div>
    </section>

    <!-- FAQ Section -->
    <section id="faq" class="card max-w-3xl mx-auto">
      <h2 class="text-3xl font-bold text-center mb-8">‚ùì FAQ</h2>

      <div class="space-y-4">
        <div class="faq-item">
          <div class="faq-header" onclick="toggleFAQ(0)">
            <span class="font-semibold">What's the token tax?</span>
            <span class="faq-arrow">‚Üì</span>
          </div>
          <div class="faq-content">
            <p>5% total tax on all transactions:</p>
            <ul style="list-style: disc; margin-left: 20px;">
              <li>3% Marketing</li>
              <li>2% Automatic Liquidity</li>
            </ul>
          </div>
        </div>

        <div class="faq-item">
          <div class="faq-header" onclick="toggleFAQ(1)">
            <span class="font-semibold">How to claim after presale?</span>
            <span class="faq-arrow">‚Üì</span>
          </div>
          <div class="faq-content">
            <p>Tokens will be automatically airdropped to your wallet within 24 hours of launch. No manual claiming needed.</p>
          </div>
        </div>

        <div class="faq-item">
          <div class="faq-header" onclick="toggleFAQ(2)">
            <span class="font-semibold">What's the vesting schedule?</span>
            <span class="faq-arrow">‚Üì</span>
          </div>
          <div class="faq-content">
            <ul style="list-style: disc; margin-left: 20px;">
              <li>Presale tokens: 100% unlocked at TGE</li>
              <li>Team tokens: 24-month linear vesting</li>
            </ul>
          </div>
        </div>

        <div class="faq-item">
          <div class="faq-header" onclick="toggleFAQ(3)">
            <span class="font-semibold">How do I buy $FLUFFI?</span>
            <span class="faq-arrow">‚Üì</span>
          </div>
          <div class="faq-content">
            <p>Connect your wallet, enter amount in BNB, and click "Buy Now".</p>
          </div>
        </div>
      </div>
    </section>

    <!-- About & Team Section -->
    <div class="grid grid-2 gap-8">
      <div class="card">
        <h2 class="text-2xl font-bold mb-4">Why FLUFFI Coin?</h2>
        <div class="space-y-4">
          <p>FLUFFI Coin combines viral meme appeal with powerful real-world utility and DeFi innovation:</p>
          <div class="space-y-2">
            <div><strong>NFT STAKING PLATFORM</strong><br />Launching Q3 2025 ‚Äì Stake FLUFFI NFTs to earn exclusive rewards</div>
            <div><strong>COMMUNITY DAO GOVERNANCE</strong><br />Vote on major decisions like treasury use and protocol upgrades</div>
            <div><strong>DEFLATIONARY MECHANICS</strong><br />1% burn on every transaction reduces supply permanently</div>
          </div>
          <p>FLUFFI bridges meme culture with sustainable financial infrastructure for the future.</p>
        </div>
      </div>

      <div class="card">
        <h2 class="text-2xl font-bold mb-4">Our Team</h2>
        <div class="space-y-6">
          <div class="text-center">
            <div class="w-20 h-20 mx-auto rounded-full flex items-center justify-center text-white font-bold text-xl mb-2" style="background: linear-gradient(45deg, #3b82f6, #8b5cf6);">
              JC
            </div>
            <h3 class="font-semibold">James Chen</h3>
            <p class="text-sm text-gray-600">Former Lead Blockchain Architect at ConsenSys. 12 years experience in smart contract development.</p>
          </div>
          
          <div class="text-center">
            <div class="w-20 h-20 mx-auto rounded-full flex items-center justify-center text-white font-bold text-xl mb-2" style="background: linear-gradient(45deg, #ec4899, #ef4444);">
              PP
            </div>
            <h3 class="font-semibold">Priya Patel</h3>
            <p class="text-sm text-gray-600">Ex-Senior Engineer at Polygon. Specialized in ZK-rollups and Layer 2 scaling solutions.</p>
          </div>
        </div>
      </div>
    </div>
  </main>
  
  <footer class="mt-16 p-6" style="background: #f9fafb; border-top: 1px solid #e5e7eb;">
    <div class="container flex justify-between items-center flex-responsive">
      <div class="text-sm text-gray-600">¬© 2025 $FLUFFI Token - All Rights Reserved</div>
      <div class="flex gap-4">
        <a href="https://t.me/FLUFFISOLANALAYER2" target="_blank" class="text-gray-600 hover:text-gray-900">
          üì± Telegram
        </a>
        <a href="https://x.com/FLUFFIOFFICIAL" target="_blank" class="text-gray-600 hover:text-gray-900">
          üê¶ Twitter
        </a>
      </div>
    </div>
  </footer>

  <!-- Wallet Modal -->
  <div id="walletModal" class="modal hidden">
    <div class="modal-content">
      <div class="flex justify-between items-center mb-6">
        <h3 class="text-xl font-bold">Connect Wallet</h3>
        <button onclick="closeWalletModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
      </div>
      
      <div class="space-y-3">
        <div class="wallet-option" onclick="connectMetaMask()">
          <div class="wallet-icon bg-orange-500 flex items-center justify-center text-white font-bold">M</div>
          <div>
            <div class="font-semibold">MetaMask</div>
            <div class="text-sm text-gray-500">Browser extension</div>
          </div>
        </div>
        
        <div class="wallet-option" onclick="connectWalletConnect()">
          <div class="wallet-icon bg-blue-500 flex items-center justify-center text-white font-bold">W</div>
          <div>
            <div class="font-semibold">WalletConnect</div>
            <div class="text-sm text-gray-500">Mobile wallets</div>
          </div>
        </div>
        
        <div class="wallet-option" onclick="connectCoinbaseWallet()">
          <div class="wallet-icon bg-blue-600 flex items-center justify-center text-white font-bold">C</div>
          <div>
            <div class="font-semibold">Coinbase Wallet</div>
            <div class="text-sm text-gray-500">Mobile & browser</div>
          </div>
        </div>
        
        <div class="wallet-option" onclick="connectTrustWallet()">
          <div class="wallet-icon bg-blue-400 flex items-center justify-center text-white font-bold">T</div>
          <div>
            <div class="font-semibold">Trust Wallet</div>
            <div class="text-sm text-gray-500">Mobile wallet</div>
          </div>
        </div>
      </div>
      
      <div class="mt-6 text-center text-sm text-gray-500">
        By connecting, you agree to our Terms of Service
      </div>
    </div>
  </div>

  <!-- Reset Timer Button (for testing) -->
  <button onclick="resetTimer()" class="btn-danger fixed bottom-4 right-4">
    Reset Timer
  </button>

  <script>
    // =========================
    // GLOBAL VARIABLES
    // =========================
    let userWalletAddress = null;
    let provider = null;
    let signer = null;
    let tokenChart = null;
    let isDarkMode = false;
    
    // Timer Configuration
    const TOTAL_STAGES = 15;
    const STAGE_DURATION = 60 * 1000; // 1 minute per stage
    const PRESALE_DURATION = TOTAL_STAGES * STAGE_DURATION; // 15 minutes total
    
    // Contract Configuration
    const CONTRACT_ADDRESS = "0x60A94bc12d0d4F782Fd597e5E1222247CFb7E297";
    const CONTRACT_ABI = [
      {"inputs":[],"stateMutability":"nonpayable","type":"constructor"},
      {"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":true,"internalType":"address","name":"referrer","type":"address"}],"name":"Contribution","type":"event"},
      {"inputs":[{"internalType":"address","name":"referrer","type":"address"}],"name":"contribute","outputs":[],"stateMutability":"payable","type":"function"},
      {"inputs":[],"name":"presaleActive","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"}
    ];

    let startTime = Date.now();

    // =========================
    // UTILITY FUNCTIONS
    // =========================
    function showMessage(message, type = 'info') {
      const container = document.getElementById('messageContainer');
      const messageDiv = document.createElement('div');
      messageDiv.className = type === 'error' ? 'alert' : 'alert';
      messageDiv.style.background = type === 'error' ? '#fee2e2' : '#dcfce7';
      messageDiv.style.color = type === 'error' ? '#dc2626' : '#16a34a';
      messageDiv.style.borderLeftColor = type === 'error' ? '#dc2626' : '#16a34a';
      messageDiv.textContent = message;
      
      container.innerHTML = '';
      container.appendChild(messageDiv);
      
      setTimeout(() => {
        messageDiv.remove();
      }, 5000);
    }

    function isValidAddress(address) {
      return /^0x[a-fA-F0-9]{40}$/.test(address);
    }

    async function switchToCorrectNetwork() {
      try {
        await window.ethereum.request({
          method: 'wallet_switchEthereumChain',
          params: [{ chainId: '0x38' }]
        });
        return true;
      } catch (switchError) {
        if (switchError.code === 4902) {
          try {
            await window.ethereum.request({
              method: 'wallet_addEthereumChain',
              params: [{
                chainId: '0x38',
                chainName: 'BNB Smart Chain',
                nativeCurrency: { name: 'BNB', symbol: 'BNB', decimals: 18 },
                rpcUrls: ['https://bsc-dataseed.binance.org/'],
                blockExplorerUrls: ['https://bscscan.com/']
              }]
            });
            return true;
          } catch (addError) {
            throw new Error('Failed to add BSC network');
          }
        }
        throw switchError;
      }
    }

    // =========================
    // TIMER FUNCTIONS
    // =========================
    function getPresaleStartTime() {
      let savedStartTime = localStorage.getItem('presaleStartTime');
      if (!savedStartTime) {
        savedStartTime = startTime;
        localStorage.setItem('presaleStartTime', savedStartTime);
      }
      return parseInt(savedStartTime);
    }

    function updateTimers() {
      const now = Date.now();
      const startTime = getPresaleStartTime();
      const endTime = startTime + PRESALE_DURATION;
      const timeLeft = Math.max(0, endTime - now);

      // Calculate stage progress
      const currentStage = Math.min(
        Math.floor((now - startTime) / STAGE_DURATION),
        TOTAL_STAGES - 1
      );
      const stageEndTime = startTime + ((currentStage + 1) * STAGE_DURATION);
      const stageTimeLeft = Math.max(0, stageEndTime - now);
      const stageProgress = Math.max(0, Math.min(100, ((STAGE_DURATION - stageTimeLeft) / STAGE_DURATION) * 100));

      // Update displays
      document.getElementById('current-stage').textContent = currentStage + 1;
      document.getElementById('stage-progress-text').textContent = stageProgress.toFixed(1);
      document.getElementById('stageProgressBar').style.width = `${stageProgress}%`;

      // Update price
      const price = (0.0001 * Math.pow(1.05, currentStage)).toFixed(6);
      document.getElementById('currentPrice').textContent = `$${price}`;

      // Update timers
      if (timeLeft <= 0) {
        document.getElementById('presale-timer').innerHTML = "üéâ Presale Ended!";
      } else {
        const minutes = Math.floor(timeLeft / (1000 * 60));
        const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
        document.getElementById('presale-minutes').textContent = minutes.toString().padStart(2, '0');
        document.getElementById('presale-seconds').textContent = seconds.toString().padStart(2, '0');
      }
    }

    function resetTimer() {
      startTime = Date.now();
      localStorage.setItem('presaleStartTime', startTime.toString());
      showMessage('Timer reset successfully!', 'success');
    }

    // =========================
    // THEME FUNCTIONS
    // =========================
    function toggleDarkMode() {
      isDarkMode = !isDarkMode;
      const body = document.body;
      const themeIcon = document.getElementById('themeIcon');
      
      if (isDarkMode) {
        body.classList.add('dark');
        themeIcon.textContent = '‚òÄÔ∏è';
      } else {
        body.classList.remove('dark');
        themeIcon.textContent = 'üåô';
      }
      
      localStorage.setItem('darkMode', isDarkMode.toString());
      
      // Update chart if it exists
      if (tokenChart) {
        tokenChart.options.plugins.legend.labels.color = isDarkMode ? '#FFFFFF' : '#111827';
        tokenChart.update();
      }
    }

    // =========================
    // TAB FUNCTIONS
    // =========================
    function switchTab(tabName) {
      // Hide all tab contents
      const tabContents = document.querySelectorAll('.tab-content');
      tabContents.forEach(content => content.classList.remove('active'));
      
      // Remove active class from all tabs
      const tabs = document.querySelectorAll('.tab');
      tabs.forEach(tab => tab.classList.remove('active'));
      
      // Show selected tab content
      document.getElementById(`${tabName}-tab`).classList.add('active');
      
      // Add active class to selected tab
      event.target.classList.add('active');
    }

    // =========================
    // FAQ FUNCTIONS
    // =========================
    function toggleFAQ(index) {
      const faqItems = document.querySelectorAll('.faq-item');
      const faqContent = faqItems[index].querySelector('.faq-content');
      const faqArrow = faqItems[index].querySelector('.faq-arrow');
      
      const isActive = faqContent.classList.contains('active');
      
      // Close all FAQ items
      faqItems.forEach((item, i) => {
        const content = item.querySelector('.faq-content');
        const arrow = item.querySelector('.faq-arrow');
        content.classList.remove('active');
        arrow.classList.remove('active');
      });
      
      // Open clicked item if it wasn't active
      if (!isActive) {
        faqContent.classList.add('active');
        faqArrow.classList.add('active');
      }
    }

    // =========================
    // WALLET CONNECTION FUNCTIONS
    // =========================
    function openWalletModal() {
      document.getElementById('walletModal').classList.remove('hidden');
    }

    function closeWalletModal() {
      document.getElementById('walletModal').classList.add('hidden');
    }

    async function connectMetaMask() {
      try {
        if (!window.ethereum) {
          throw new Error('MetaMask not detected. Please install MetaMask browser extension.');
        }

        const accounts = await window.ethereum.request({ 
          method: 'eth_requestAccounts' 
        });
        
        if (accounts.length === 0) {
          throw new Error('No accounts found. Please unlock MetaMask.');
        }

        await switchToCorrectNetwork();
        
        provider = new ethers.BrowserProvider(window.ethereum);
        signer = await provider.getSigner();
        userWalletAddress = accounts[0];
        
        updateWalletUI();
        closeWalletModal();
        showMessage('Successfully connected to MetaMask!', 'success');
        
      } catch (error) {
        console.error('MetaMask connection error:', error);
        showMessage(error.message || 'Failed to connect to MetaMask', 'error');
      }
    }

    async function connectWalletConnect() {
      showMessage('WalletConnect integration coming soon!', 'info');
    }

    async function connectCoinbaseWallet() {
      try {
        if (window.ethereum && window.ethereum.isCoinbaseWallet) {
          const accounts = await window.ethereum.request({ 
            method: 'eth_requestAccounts' 
          });
          
          await switchToCorrectNetwork();
          
          provider = new ethers.BrowserProvider(window.ethereum);
          signer = await provider.getSigner();
          userWalletAddress = accounts[0];
          
          updateWalletUI();
          closeWalletModal();
          showMessage('Successfully connected to Coinbase Wallet!', 'success');
        } else {
          throw new Error('Coinbase Wallet not detected.');
        }
      } catch (error) {
        showMessage(error.message || 'Failed to connect to Coinbase Wallet', 'error');
      }
    }

    async function connectTrustWallet() {
      try {
        if (window.ethereum) {
          const accounts = await window.ethereum.request({ 
            method: 'eth_requestAccounts' 
          });
          
          await switchToCorrectNetwork();
          
          provider = new ethers.BrowserProvider(window.ethereum);
          signer = await provider.getSigner();
          userWalletAddress = accounts[0];
          
          updateWalletUI();
          closeWalletModal();
          showMessage('Successfully connected to Trust Wallet!', 'success');
        } else {
          throw new Error('Trust Wallet not detected.');
        }
      } catch (error) {
        showMessage(error.message || 'Failed to connect to Trust Wallet', 'error');
      }
    }

    function updateWalletUI() {
      const walletButton = document.getElementById('walletButton');
      const walletAddress = document.getElementById('walletAddress');
      const disconnectButton = document.getElementById('disconnectButton');
      
      if (userWalletAddress) {
        walletButton.textContent = 'Connected ‚úì';
        walletButton.style.background = '#059669';
        
        walletAddress.textContent = `${userWalletAddress.slice(0, 6)}...${userWalletAddress.slice(-4)}`;
        walletAddress.classList.remove('hidden');
        
        disconnectButton.classList.remove('hidden');
        
        // Update referral section
        showReferralUI(userWalletAddress);
      }
    }

    function disconnectWallet() {
      userWalletAddress = null;
      provider = null;
      signer = null;
      
      const walletButton = document.getElementById('walletButton');
      const walletAddress = document.getElementById('walletAddress');
      const disconnectButton = document.getElementById('disconnectButton');
      
      walletButton.textContent = 'Connect Wallet';
      walletButton.style.background = '#10b981';
      
      walletAddress.classList.add('hidden');
      disconnectButton.classList.add('hidden');
      
      // Reset referral section
      document.getElementById('referralSection').innerHTML = `
        <p class="mb-4">Connect your wallet to access your referral link and start earning!</p>
        <button onclick="connectReferralWallet()" class="btn-primary">
          Connect Wallet for Referrals
        </button>
      `;
      
      showMessage('Wallet disconnected successfully', 'success');
    }

    // =========================
    // BUY TOKEN FUNCTION
    // =========================
    async function buyFluffi() {
      try {
        if (!userWalletAddress) {
          openWalletModal();
          return;
        }

        const amountInput = document.getElementById('amountInput');
        const currencySelect = document.getElementById('currencySelect');
        const refInput = document.getElementById('refInput');
        
        const amount = amountInput.value;
        const currency = currencySelect.value;
        const ref = refInput.value;
        
        if (!amount || isNaN(amount) || Number(amount) <= 0) {
          throw new Error('Please enter a valid amount.');
        }
        
        let ethValue;
        if (currency === 'USD') {
          const usdToBnb = 600; // 1 BNB = 600 USD
          ethValue = (Number(amount) / usdToBnb).toFixed(6);
        } else {
          ethValue = Number(amount).toFixed(6);
        }
        
        if (Number(ethValue) <= 0) {
          throw new Error('Amount too small.');
        }

        const buyButton = document.getElementById('buyButton');
        buyButton.textContent = 'Processing...';
        buyButton.disabled = true;
        
        const refAddr = (ref && isValidAddress(ref)) ? ref : '0x0000000000000000000000000000000000000000';
        
        // For demo purposes, simulate a successful transaction
        await new Promise(resolve => setTimeout(resolve, 2000));
        
        showMessage(`üéâ Purchase successful! Bought ${amount} ${currency} worth of FLUFFI tokens.`, 'success');
        
        // Update tokens sold counter
        const tokensSoldElement = document.getElementById('tokensSold');
        const currentSold = parseInt(tokensSoldElement.textContent.replace(/,/g, ''));
        const newSold = currentSold + Math.floor(Number(amount) * 10000);
        tokensSoldElement.textContent = newSold.toLocaleString();
        
        // Clear form
        amountInput.value = '';
        refInput.value = '';
        
      } catch (error) {
        console.error('Buy FLUFFI error:', error);
        showMessage(error.message || 'Transaction failed. Please try again.', 'error');
      } finally {
        const buyButton = document.getElementById('buyButton');
        buyButton.textContent = 'üöÄ Buy Now';
        buyButton.disabled = false;
      }
    }

    // =========================
    // REFERRAL FUNCTIONS
    // =========================
    async function connectReferralWallet() {
      if (!userWalletAddress) {
        openWalletModal();
      }
    }

    function showReferralUI(wallet) {
      const referralLink = `${window.location.href.split('?')[0]}?ref=${wallet}`;
      
      document.getElementById('referralSection').innerHTML = `
        <div class="space-y-4">
          <div>
            <label class="font-semibold mb-2 block">Your referral link:</label>
            <div class="flex gap-2">
              <input type="text" id="referralLinkInput" 
                     value="${referralLink}" 
                     class="input flex-1" readonly>
              <button onclick="copyReferralLink()" class="btn-secondary">
                Copy
              </button>
            </div>
          </div>
          
          <div class="card">
            <div class="grid grid-2 gap-4 text-center">
              <div>
                <div class="text-sm text-gray-600">Total Referrals</div>
                <div class="text-2xl font-bold">0</div>
              </div>
              <div>
                <div class="text-sm text-gray-600">Earnings</div>
                <div class="text-2xl font-bold">0 FLUFFI</div>
              </div>
            </div>
          </div>
          
          <div>
            <div class="text-sm font-semibold mb-2">Share your link:</div>
            <div class="flex gap-2">
              <button onclick="shareOnTwitter()" class="btn-secondary">
                üê¶ Twitter
              </button>
              <button onclick="shareOnTelegram()" class="btn-secondary">
                üì± Telegram
              </button>
            </div>
          </div>
        </div>
      `;
    }

    function copyReferralLink() {
      const input = document.getElementById('referralLinkInput');
      if (input) {
        input.select();
        document.execCommand('copy');
        showMessage('Referral link copied to clipboard!', 'success');
      }
    }
    
    function shareOnTwitter() {
      const linkElement = document.getElementById('referralLinkInput');
      if (linkElement) {
        const link = linkElement.value;
        window.open(`https://twitter.com/intent/tweet?text=Join%20$FLUFFI%20presale!%20üöÄ%20Use%20my%20referral%20link%20for%20bonus%20tokens:%20${encodeURIComponent(link)}%20%23FluffiArmy`, '_blank');
      }
    }
    
    function shareOnTelegram() {
      const linkElement = document.getElementById('referralLinkInput');
      if (linkElement) {
        const link = encodeURIComponent(linkElement.value);
        window.open(`https://t.me/share/url?url=${link}&text=Check%20out%20$FLUFFI%20presale%20with%20my%20referral%20link!`, '_blank');
      }
    }

    // =========================
    // STAKING FUNCTION
    // =========================
    function stakeFluffi() {
      const stakeInput = document.getElementById('stakeInput');
      const amount = stakeInput.value;
      
      if (!userWalletAddress) {
        showMessage('Please connect your wallet first', 'error');
        return;
      }
      
      if (!amount || isNaN(amount) || Number(amount) <= 0) {
        showMessage('Please enter a valid staking amount', 'error');
        return;
      }
      
      showMessage(`Staking ${amount} FLUFFI tokens! (Demo mode)`, 'success');
      stakeInput.value = '';
    }

    // =========================
    // CHART INITIALIZATION
    // =========================
    function initializeChart() {
      const ctx = document.getElementById('tokenChart');
      if (!ctx) return;

      const chartData = {
        labels: ['Presale (40%)', 'Liquidity (30%)', 'Staking (20%)', 'Marketing (5%)', 'Team (5%)'],
        datasets: [{
          data: [40, 30, 20, 5, 5],
          backgroundColor: [
            '#10B981', // Green
            '#3B82F6', // Blue
            '#F59E0B', // Yellow
            '#EF4444', // Red
            '#8B5CF6'  // Purple
          ],
          borderWidth: 2,
          borderColor: '#ffffff'
        }]
      };

      const chartOptions = {
        cutout: '65%',
        plugins: {
          legend: {
            position: 'bottom',
            labels: {
              color: isDarkMode ? '#FFFFFF' : '#111827',
              font: {
                size: 14,
                family: "'Inter', sans-serif"
              },
              padding: 20,
            }
          }
        },
        responsive: true,
        maintainAspectRatio: false
      };

      tokenChart = new Chart(ctx, {
        type: 'doughnut',
        data: chartData,
        options: chartOptions
      });
    }

    // =========================
    // INITIALIZATION
    // =========================
    document.addEventListener('DOMContentLoaded', () => {
      // Initialize dark mode from localStorage
      const savedTheme = localStorage.getItem('darkMode');
      if (savedTheme === 'true') {
        isDarkMode = true;
        document.body.classList.add('dark');
        document.getElementById('themeIcon').textContent = '‚òÄÔ∏è';
      }

      // Initialize chart
      initializeChart();

      // Start timers
      updateTimers();
      setInterval(updateTimers, 1000);

      // Check for referral in URL
      const urlParams = new URLSearchParams(window.location.search);
      const ref = urlParams.get('ref');
      if (ref && isValidAddress(ref)) {
        const refInput = document.getElementById('refInput');
        if (refInput) {
          refInput.value = ref;
        }
      }

      // Close modal when clicking outside
      document.getElementById('walletModal').addEventListener('click', (e) => {
        if (e.target.id === 'walletModal') {
          closeWalletModal();
        }
      });
    });

    // Handle account changes
    if (typeof window !== 'undefined' && window.ethereum) {
      window.ethereum.on('accountsChanged', (accounts) => {
        if (accounts.length === 0) {
          disconnectWallet();
        } else if (userWalletAddress && accounts[0] !== userWalletAddress) {
          userWalletAddress = accounts[0];
          updateWalletUI();
          showMessage('Account changed', 'success');
        }
      });

      window.ethereum.on('chainChanged', () => {
        window.location.reload();
      });
    }
  </script>
</body>
</html>
