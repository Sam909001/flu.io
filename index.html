<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>$FLUFFI Presale & Staking</title>
  <meta name="description" content="$FLUFFI is a Solana Layer 2 meme token with presale and staking features. Join the community and earn rewards." />
  <meta name="keywords" content="Fluffi, $FLUFFI, crypto, presale, staking, Solana, meme token" />
  <meta name="author" content="FLUFFI Team" />
  
  <!-- Essential Scripts - No Duplicates -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.9.0/dist/ethers.umd.min.js"></script>
  <script src="https://unpkg.com/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <!-- Tailwind CSS -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <style>
    :root {
      --primary-green: #16a34a;
      --primary-blue: #3b82f6;
      --primary-yellow: #f59e0b;
      --primary-red: #ef4444;
      --primary-purple: #8b5cf6;
    }

    body {
      background: linear-gradient(to bottom, #fdf2f8, #fefce8);
      color: #1a1a1a;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      transition: all 0.3s ease;
    }
    
    .dark {
      background: linear-gradient(to bottom, #111827, #1f2937) !important;
      color: #f9fafb !important;
    }

    .dark .bg-white {
      background-color: #1f2937 !important;
      color: #f9fafb !important;
    }

    .dark .text-gray-600 { color: #d1d5db !important; }
    .dark .text-gray-500 { color: #9ca3af !important; }
    .dark .text-gray-800 { color: #f9fafb !important; }
    .dark .text-gray-700 { color: #e5e7eb !important; }
    .dark .text-gray-900 { color: #f9fafb !important; }
    .dark .bg-gray-100 { background-color: #374151 !important; }
    .dark .bg-gray-200 { background-color: #4b5563 !important; }
    .dark .border-gray-200 { border-color: #4b5563 !important; }
    .dark .border-gray-300 { border-color: #6b7280 !important; }

    /* Enhanced dark mode text visibility */
    .dark h1, .dark h2, .dark h3, .dark h4, .dark h5, .dark h6,
    .dark p, .dark span, .dark div, .dark li, .dark label,
    .dark .font-bold, .dark .font-semibold, .dark .font-medium {
      color: #f9fafb !important;
    }

    .dark .text-green-600 { color: #34d399 !important; }
    .dark .text-green-700 { color: #10b981 !important; }
    .dark .text-blue-600 { color: #60a5fa !important; }
    .dark .text-blue-700 { color: #3b82f6 !important; }
    .dark .text-purple-700 { color: #a78bfa !important; }
    .dark .text-yellow-600 { color: #fbbf24 !important; }
    .dark .text-red-600 { color: #f87171 !important; }

    /* Logo Animation */
    .logo-bounce {
      animation: fluffi-float 3s ease-in-out infinite;
    }

    @keyframes fluffi-float {
      0%, 100% { 
        transform: translateY(0) scale(1) rotate(0deg); 
      }
      50% { 
        transform: translateY(-10px) scale(1.05) rotate(2deg); 
      }
    }

    /* Button Animations */
    .btn-primary {
      background: linear-gradient(135deg, var(--primary-green), #059669);
      transition: all 0.3s ease;
      transform: translateY(0);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(22, 163, 74, 0.3);
    }

    /* Progress Bar */
    .progress-bar {
      background: linear-gradient(90deg, var(--primary-green), #059669);
      transition: width 1s ease-in-out;
    }

    /* Price Tooltip */
    .price-tooltip {
      position: relative;
      display: inline-block;
      margin-left: 8px;
    }

    .price-tooltip .tooltip-text {
      visibility: hidden;
      width: 250px;
      background-color: #1f2937;
      color: #f9fafb;
      text-align: center;
      border-radius: 8px;
      padding: 12px;
      position: absolute;
      z-index: 1000;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 14px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.2);
    }

    .price-tooltip .tooltip-text::after {
      content: "";
      position: absolute;
      top: 100%;
      left: 50%;
      margin-left: -5px;
      border-width: 5px;
      border-style: solid;
      border-color: #1f2937 transparent transparent transparent;
    }

    .price-tooltip:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
    }

    .dark .price-tooltip .tooltip-text {
      background-color: #f9fafb;
      color: #1f2937;
    }

    .dark .price-tooltip .tooltip-text::after {
      border-color: #f9fafb transparent transparent transparent;
    }

    /* Wallet Modal */
    .wallet-modal {
      backdrop-filter: blur(10px);
      background: rgba(0, 0, 0, 0.7);
    }

    .wallet-option {
      padding: 16px;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .wallet-option:hover {
      border-color: var(--primary-green);
      background-color: #f0fdf4;
      transform: translateY(-2px);
    }

    .dark .wallet-option {
      border-color: #4b5563;
      background-color: #374151;
    }

    .dark .wallet-option:hover {
      border-color: var(--primary-green);
      background-color: #1f2937;
    }

    .wallet-icon {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      object-fit: cover;
    }

    /* FAQ Animations */
    .faq-item {
      transition: all 0.3s ease;
    }

    .faq-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    }

    /* Team Section */
    .team-member {
      transition: all 0.3s ease;
    }

    .team-member:hover {
      transform: translateY(-8px);
    }

    .team-member img {
      border: 4px solid var(--primary-green);
      transition: all 0.3s ease;
    }

    .team-member:hover img {
      border-color: var(--primary-blue);
    }

    /* Mobile Optimizations */
    @media (max-width: 768px) {
      .mobile-stack {
        flex-direction: column;
        gap: 16px;
      }
      
      .mobile-full {
        width: 100%;
      }
      
      .mobile-text-center {
        text-align: center;
      }
    }

    /* Loading States */
    .loading {
      opacity: 0.7;
      pointer-events: none;
    }

    .pulse {
      animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: .5; }
    }

    /* Utility Classes */
    .hidden { display: none !important; }
    .flex { display: flex; }
    .items-center { align-items: center; }
    .justify-center { justify-content: center; }
    .justify-between { justify-content: space-between; }
    .gap-2 { gap: 8px; }
    .gap-4 { gap: 16px; }
    .gap-6 { gap: 24px; }
    .rounded-lg { border-radius: 8px; }
    .rounded-xl { border-radius: 12px; }
    .shadow-lg { box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
    .transition-all { transition: all 0.3s ease; }

    /* Connection Status */
    .connection-status {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 10px 15px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: bold;
      z-index: 1000;
      transition: all 0.3s ease;
    }

    .connection-status.connected {
      background-color: #10b981;
      color: white;
    }

    .connection-status.disconnected {
      background-color: #ef4444;
      color: white;
    }
  </style>
</head>

<body class="text-gray-800 dark:text-white">
  <!-- Connection Status Indicator -->
  <div id="connectionStatus" class="connection-status disconnected hidden">
    <i class="fas fa-wifi"></i> <span id="statusText">Disconnected</span>
  </div>

  <!-- Header -->
  <header class="flex flex-col md:flex-row items-center justify-between px-4 py-3 bg-green-600 shadow sticky top-0 z-50">
    <div class="flex items-center gap-3">
      <img src="https://images.pexels.com/photos/1108099/pexels-photo-1108099.jpeg?auto=compress&cs=tinysrgb&w=80&h=80&fit=crop" 
           alt="$FLUFFI Logo" class="w-10 h-10 rounded-full logo-bounce">
      <h1 class="text-3xl md:text-4xl font-bold text-white hover:scale-105 transition-transform duration-300">
        $FLUFFI
      </h1>
    </div>
    
    <nav class="flex flex-wrap gap-4 mt-2 md:mt-0 text-sm font-semibold items-center">
      <a href="#presale" class="text-white hover:underline transition-colors">Presale</a>
      <a href="#staking" class="text-white hover:underline transition-colors">Staking</a>
      <a href="#faq" class="text-white hover:underline transition-colors">FAQ</a>
      <a href="#team" class="text-white hover:underline transition-colors">Team</a>
      
      <!-- Missing buttons added back -->
      <a href="#referral" class="text-white hover:underline transition-colors">Referral</a>
      <button onclick="showHowToBuy()" class="bg-green-700 hover:bg-green-800 text-white py-2 px-4 rounded transition-colors">
        How to Buy FLUFFI
      </button>
      
      <button onclick="toggleTheme()" class="ml-2 bg-gray-300 hover:bg-gray-400 dark:bg-gray-600 dark:hover:bg-gray-500 px-3 py-2 rounded text-black dark:text-white transition-colors">
        <i class="fas fa-moon dark:hidden"></i>
        <i class="fas fa-sun hidden dark:inline"></i>
      </button>
      
      <button onclick="showWalletModal()" id="walletButton" 
              class="bg-green-700 hover:bg-green-800 text-white py-2 px-4 rounded transition-colors">
        Connect Wallet
      </button>
      
      <div id="walletInfo" class="hidden flex items-center gap-2">
        <span id="walletAddress" class="text-white text-sm"></span>
        <button onclick="disconnectWallet()" 
                class="bg-red-600 hover:bg-red-700 text-white py-1 px-3 rounded transition-colors">
          Disconnect
        </button>
      </div>
    </nav>
  </header>

  <main class="p-6 mx-auto w-full max-w-6xl">
    <!-- Timer Section -->
    <div id="countdown-container" class="text-center my-10 bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg max-w-xl mx-auto transition-colors duration-300">
      <h3 class="text-xl font-bold mb-4 text-gray-800 dark:text-gray-100">🚀 PRESALE ENDS IN:</h3>
      <div id="presale-timer" class="text-2xl font-mono text-red-600 dark:text-red-300 space-x-3">
        <span id="presale-minutes">15</span>:<span id="presale-seconds">00</span>
      </div>
      
      <div class="mt-6 pt-6 border-t border-gray-200 dark:border-gray-700">
        <h4 class="text-lg font-semibold mb-2 text-gray-700 dark:text-gray-300">Current Stage Progress</h4>
        
        <div class="w-full bg-gray-300 dark:bg-gray-600 h-4 rounded-full overflow-hidden mb-2">
          <div id="stageProgressBar" class="h-full progress-bar" style="width: 0%"></div>
        </div>

        <div class="flex justify-between text-sm font-mono text-gray-700 dark:text-gray-300">
          <span>Stage: <span id="current-stage">1</span>/15</span>
          <span>Ends in: <span id="stage-seconds">60</span>s</span>
        </div>
      </div>
    </div>

    <!-- Presale Section -->
    <section id="presale" class="mb-6 p-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg transition-colors duration-300">
      <h2 class="text-2xl font-bold mb-4 text-gray-800 dark:text-gray-100">🚀 Presale is Live!</h2>

      <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
        <div class="flex-1">
          <div class="flex items-center gap-2 mb-2">
            <i class="fas fa-chart-line text-green-500 animate-pulse"></i>
            <span class="font-mono text-lg font-bold text-gray-800 dark:text-gray-100" id="tokensSold">67,431,509</span>
            <span class="text-sm text-gray-500 dark:text-gray-300">FLUFFI sold</span>
          </div>
        </div>
        
        <div class="text-right">
          <div class="flex items-center justify-end gap-2 mb-1">
            <span class="font-semibold text-lg text-gray-800 dark:text-gray-100">$FLUFFI</span>
            <span class="bg-red-500 text-white px-2 py-1 rounded text-xs font-bold pulse">
              LIVE
            </span>
          </div>
          <div class="text-2xl font-bold text-green-600 dark:text-green-400" id="currentPrice">
            $0.000100
            <span class="price-tooltip">
              <i class="fas fa-info-circle text-blue-500 cursor-pointer"></i>
              <span class="tooltip-text">
                <strong>Price Increase:</strong><br>
                +5% per stage (every 1 minute)<br>
                Next increase: <span id="nextIncreaseTime">00:59</span>
              </span>
            </span>
          </div>
          <div class="text-sm text-gray-500 dark:text-gray-400">+5% per stage</div>
        </div>
      </div>

      <p class="mb-4 text-green-600 dark:text-green-400 font-semibold">🎯 Referral Bonus: <strong>10%</strong></p>

      <div class="space-y-4">
        <div class="flex gap-2">
          <input type="number" placeholder="Amount" id="amountInput" 
                 class="flex-1 p-3 border rounded-lg text-black dark:text-white dark:bg-gray-700 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors" />
          <select id="currencySelect" 
                  class="p-3 border rounded-lg text-black dark:text-white dark:bg-gray-700 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors">
            <option value="USD">USD</option>
            <option value="ETH">ETH</option>
          </select>
        </div>
        
        <input type="text" placeholder="Referral wallet (optional)" id="refInput" 
               class="w-full p-3 border rounded-lg text-black dark:text-white dark:bg-gray-700 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors" />
        
        <button onclick="buyFluffi()" id="buyButton"
                class="w-full btn-primary text-white py-3 px-6 rounded-lg font-semibold text-lg">
          🚀 Buy Now
        </button>
      </div>
    </section>

    <!-- Referral Section -->
    <section id="referral" class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6 transition-colors duration-300">
      <h2 class="text-2xl font-bold mb-4 text-gray-800 dark:text-gray-100">💰 Earn with Referrals</h2>
      <div id="referralSection">
        <p class="mb-4 text-gray-600 dark:text-gray-300">Connect your wallet to access your referral link and start earning!</p>
        <button onclick="connectForReferrals()" 
                class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg font-semibold transition-colors">
          Connect Wallet for Referrals
        </button>
      </div>
    </section>

    <!-- Claim Section -->
    <section class="p-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg mb-6 transition-colors duration-300">
      <h2 class="text-2xl font-bold mb-4 flex items-center gap-2 text-gray-800 dark:text-gray-100">
        <i class="fas fa-gift text-blue-500"></i>
        Claim $FLUFFI
      </h2>
      <p class="mb-4 text-gray-600 dark:text-gray-300">Once the presale ends, you can claim your purchased tokens here.</p>
      <button class="w-full bg-blue-500 hover:bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold transition-colors">
        Claim Tokens
      </button>
    </section>

    <!-- Staking Section -->
    <section id="staking" class="p-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg mb-6 transition-colors duration-300">
      <h2 class="text-2xl font-bold mb-4 flex items-center gap-2 text-gray-800 dark:text-gray-100">
        <i class="fas fa-chart-line text-yellow-500"></i>
        Stake Your $FLUFFI
      </h2>
      <p class="mb-4 text-yellow-600 dark:text-yellow-400 font-semibold">APY: <strong>90%</strong> | Ends at Listing Date</p>
      <div class="space-y-4">
        <input type="number" placeholder="Amount to stake" id="stakeInput" 
               class="w-full p-3 border rounded-lg text-black dark:text-white dark:bg-gray-700 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-yellow-500 transition-colors" />
        <button onclick="stakeFluffi()" 
                class="w-full bg-yellow-500 hover:bg-yellow-600 text-white py-3 px-6 rounded-lg font-semibold transition-colors">
          Stake Now
        </button>
      </div>
    </section>

    <!-- Tokenomics Section -->
    <section id="tokenomics" class="px-6 py-10 bg-white dark:bg-gray-900 rounded-xl shadow-xl mb-12 transition-colors duration-300">
      <h2 class="text-3xl font-extrabold text-center text-green-700 dark:text-green-400 mb-8 uppercase tracking-wide">
        📊 Tokenomics
      </h2>

      <div class="grid md:grid-cols-2 gap-10 items-center">
        <div>
          <ul class="space-y-4 text-lg text-gray-900 dark:text-white">
            <li>
              <span class="font-semibold text-green-700 dark:text-green-400">Total Supply:</span>
              <span class="ml-2">10,000,000,000 FLUFFI</span>
            </li>
            <li>
              <span class="font-semibold text-green-700 dark:text-green-400">Presale:</span>
              <span class="ml-2">40%</span>
            </li>
            <li>
              <span class="font-semibold text-green-700 dark:text-green-400">Liquidity:</span>
              <span class="ml-2">30% (Locked)</span>
            </li>
            <li>
              <span class="font-semibold text-green-700 dark:text-green-400">Staking:</span>
              <span class="ml-2">20%</span>
            </li>
            <li>
              <span class="font-semibold text-green-700 dark:text-green-400">Marketing:</span>
              <span class="ml-2">5%</span>
            </li>
            <li>
              <span class="font-semibold text-green-700 dark:text-green-400">Team:</span>
              <span class="ml-2">5% (Locked)</span>
            </li>
          </ul>
        </div>

        <div class="flex justify-center">
          <div class="w-80 h-80">
            <canvas id="tokenChart" width="280" height="280"></canvas>
          </div>
        </div>
      </div>
    </section>

    <!-- FAQ Section -->
    <section id="faq" class="p-6 bg-white dark:bg-gray-900 rounded-xl shadow-lg mb-10 max-w-3xl mx-auto transition-colors duration-300">
      <h2 class="text-3xl font-bold text-center mb-6 text-purple-700 dark:text-purple-400">❓ FAQ</h2>

      <div class="space-y-4">
        <div class="faq-item border border-gray-200 dark:border-gray-700 rounded-lg">
          <button onclick="toggleFAQ(0)" class="w-full p-4 text-left font-semibold text-gray-800 dark:text-gray-100 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
            What's the token tax?
            <i class="fas fa-chevron-down transform transition-transform" id="faq-icon-0"></i>
          </button>
          <div id="faq-content-0" class="hidden px-4 pb-4 text-gray-700 dark:text-gray-300">
            <p>5% total tax on all transactions:</p>
            <ul class="list-disc list-inside ml-2 mt-2">
              <li>3% Marketing</li>
              <li>2% Automatic Liquidity</li>
            </ul>
          </div>
        </div>

        <div class="faq-item border border-gray-200 dark:border-gray-700 rounded-lg">
          <button onclick="toggleFAQ(1)" class="w-full p-4 text-left font-semibold text-gray-800 dark:text-gray-100 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
            How to claim after presale?
            <i class="fas fa-chevron-down transform transition-transform" id="faq-icon-1"></i>
          </button>
          <div id="faq-content-1" class="hidden px-4 pb-4 text-gray-700 dark:text-gray-300">
            Tokens will be automatically airdropped to your wallet within 24 hours of launch. No manual claiming needed.
          </div>
        </div>

        <div class="faq-item border border-gray-200 dark:border-gray-700 rounded-lg">
          <button onclick="toggleFAQ(2)" class="w-full p-4 text-left font-semibold text-gray-800 dark:text-gray-100 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
            What's the vesting schedule?
            <i class="fas fa-chevron-down transform transition-transform" id="faq-icon-2"></i>
          </button>
          <div id="faq-content-2" class="hidden px-4 pb-4 text-gray-700 dark:text-gray-300">
            <ul class="list-disc list-inside ml-2">
              <li>Presale tokens: 100% unlocked at TGE</li>
              <li>Team tokens: 24-month linear vesting</li>
            </ul>
          </div>
        </div>

        <div class="faq-item border border-gray-200 dark:border-gray-700 rounded-lg">
          <button onclick="toggleFAQ(3)" class="w-full p-4 text-left font-semibold text-gray-800 dark:text-gray-100 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
            How do I buy $FLUFFI?
            <i class="fas fa-chevron-down transform transition-transform" id="faq-icon-3"></i>
          </button>
          <div id="faq-content-3" class="hidden px-4 pb-4 text-gray-700 dark:text-gray-300">
            Connect your wallet, enter amount in BNB, and click "Buy Now".
          </div>
        </div>

        <div class="faq-item border border-gray-200 dark:border-gray-700 rounded-lg">
          <button onclick="toggleFAQ(4)" class="w-full p-4 text-left font-semibold text-gray-800 dark:text-gray-100 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
            When does staking end?
            <i class="fas fa-chevron-down transform transition-transform" id="faq-icon-4"></i>
          </button>
          <div id="faq-content-4" class="hidden px-4 pb-4 text-gray-700 dark:text-gray-300">
            Staking ends at the official listing date.
          </div>
        </div>

        <div class="faq-item border border-gray-200 dark:border-gray-700 rounded-lg">
          <button onclick="toggleFAQ(5)" class="w-full p-4 text-left font-semibold text-gray-800 dark:text-gray-100 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
            What chains are supported?
            <i class="fas fa-info-circle text-blue-500 cursor-pointer"></i>
          </button>
          <div id="faq-content-5" class="hidden px-4 pb-4 text-gray-700 dark:text-gray-300">
            Currently supporting BNB, with plans for ETH, SOL, and AVAX.
          </div>
        </div>
      </div>
    </section>

    <!-- Team & About Sections -->
    <div class="flex flex-col lg:flex-row gap-10 mt-16 mb-16">
      <!-- Team Section -->
      <section id="team" class="flex-1 min-w-80 bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg transition-colors duration-300">
        <h2 class="text-3xl font-bold text-center mb-8 text-green-700 dark:text-green-400 uppercase tracking-wide">
          Our Team
        </h2>
        
        <div class="space-y-8">
          <div class="team-member text-center group">
            <img src="https://images.pexels.com/photos/1222271/pexels-photo-1222271.jpeg?auto=compress&cs=tinysrgb&w=280&h=280&fit=crop"
                 alt="James Chen"
                 class="w-32 h-32 rounded-full object-cover mx-auto mb-4 transition-all duration-300">
            <h3 class="text-xl font-semibold mb-2 relative text-gray-800 dark:text-gray-100">
              James Chen
              <div class="absolute w-1/2 h-0.5 bg-gradient-to-r from-yellow-400 to-orange-500 bottom-0 left-1/4 rounded"></div>
            </h3>
            <p class="text-sm font-medium text-green-600 dark:text-green-400 mb-3">CEO</p>
            <p class="text-sm leading-relaxed text-gray-600 dark:text-gray-300">
              Former Lead Blockchain Architect at ConsenSys. 12 years experience in smart contract development and protocol design.
            </p>
          </div>

          <div class="team-member text-center group">
            <img src="https://images.pexels.com/photos/1239291/pexels-photo-1239291.jpeg?auto=compress&cs=tinysrgb&w=280&h=280&fit=crop"
                 alt="Priya Patel"
                 class="w-32 h-32 rounded-full object-cover mx-auto mb-4 transition-all duration-300">
            <h3 class="text-xl font-semibold mb-2 relative text-gray-800 dark:text-gray-100">
              Priya Patel
              <div class="absolute w-1/2 h-0.5 bg-gradient-to-r from-yellow-400 to-orange-500 bottom-0 left-1/4 rounded"></div>
            </h3>
            <p class="text-sm font-medium text-green-600 dark:text-green-400 mb-3">CTO</p>
            <p class="text-sm leading-relaxed text-gray-600 dark:text-gray-300">
              Ex-Senior Engineer at Polygon. Specialized in ZK-rollups and Layer 2 scaling solutions.
            </p>
          </div>
        </div>
      </section>

      <!-- About Section -->
      <section class="flex-1 min-w-80 bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg transition-colors duration-300">
        <h2 class="text-3xl font-bold text-center mb-8 text-green-700 dark:text-green-400 uppercase tracking-wide">
          Why Fluffi Coin?
        </h2>
        
        <div class="space-y-6 text-gray-700 dark:text-gray-300 leading-relaxed">
          <p class="text-lg">
            Fluffi Coin combines viral meme appeal with powerful real-world utility and DeFi innovation:
          </p>
          
          <ul class="space-y-6">
            <li class="flex items-start gap-4">
              <div class="w-6 h-6 bg-green-500 rounded-full flex-shrink-0 mt-1"></div>
              <div>
                <strong class="text-green-600 dark:text-green-400">NFT STAKING PLATFORM</strong>
                <br />
                Launching Q3 2025 – Stake Fluffi NFTs to earn exclusive rewards
              </div>
            </li>
            
            <li class="flex items-start gap-4">
              <div class="w-6 h-6 bg-blue-500 rounded-full flex-shrink-0 mt-1"></div>
              <div>
                <strong class="text-blue-600 dark:text-blue-400">COMMUNITY DAO GOVERNANCE</strong>
                <br />
                Vote on major decisions like treasury use and protocol upgrades
              </div>
            </li>
            
            <li class="flex items-start gap-4">
              <div class="w-6 h-6 bg-red-500 rounded-full flex-shrink-0 mt-1"></div>
              <div>
                <strong class="text-red-600 dark:text-red-400">DEFLATIONARY MECHANICS</strong>
                <br />
                1% burn on every transaction reduces supply permanently
              </div>
            </li>
          </ul>
          
          <p class="text-lg font-medium text-center pt-4 border-t border-gray-200 dark:border-gray-700">
            Fluffi bridges meme culture with sustainable financial infrastructure for the future.
          </p>
        </div>
      </section>
    </div>
  </main>

  <!-- Footer -->
  <footer class="flex flex-col md:flex-row justify-between items-center px-6 py-6 text-sm text-gray-600 dark:text-gray-300 bg-gray-100 dark:bg-gray-800 transition-colors duration-300">
    <div class="mb-4 md:mb-0">© 2025 $FLUFFI Token - All Rights Reserved</div>
    <div class="flex gap-6">
      <a href="https://t.me/FLUFFISOLANALAYER2" target="_blank" rel="noopener noreferrer"
         title="Telegram" class="hover:opacity-75 transition-opacity">
        <img src="https://images.pexels.com/photos/267350/pexels-photo-267350.jpeg?auto=compress&cs=tinysrgb&w=20&h=20&fit=crop" 
             alt="Telegram" class="w-5 h-5 rounded">
      </a>
      <a href="https://x.com/FLUFFIOFFICIAL" target="_blank" rel="noopener noreferrer"
         title="Twitter" class="hover:opacity-75 transition-opacity">
        <img src="https://images.pexels.com/photos/267350/pexels-photo-267350.jpeg?auto=compress&cs=tinysrgb&w=20&h=20&fit=crop" 
             alt="Twitter" class="w-5 h-5 rounded">
      </a>
    </div>
  </footer>

  <!-- Wallet Modal -->
  <div id="walletModal" class="hidden fixed inset-0 wallet-modal z-50 flex items-center justify-center p-4">
    <div class="bg-white dark:bg-gray-800 rounded-xl p-6 w-full max-w-md relative transition-colors duration-300">
      <button onclick="hideWalletModal()" class="absolute top-4 right-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
        <i class="fas fa-times text-xl"></i>
      </button>
      
      <h3 class="text-xl font-bold mb-6 dark:text-white">Connect Wallet</h3>
      
      <div class="grid grid-cols-1 gap-3">
        <button onclick="connectInjected()" class="wallet-option">
          <img src="https://upload.wikimedia.org/wikipedia/commons/3/36/MetaMask_Fox.svg" 
               alt="MetaMask" class="wallet-icon">
          <div class="text-left">
            <div class="font-semibold dark:text-white">Browser Wallet</div>
            <div class="text-sm text-gray-500 dark:text-gray-400">MetaMask, Brave, etc.</div>
          </div>
        </button>

        <button onclick="connectWalletConnect()" class="wallet-option">
          <img src="https://images.pexels.com/photos/844124/pexels-photo-844124.jpeg?auto=compress&cs=tinysrgb&w=80&h=80&fit=crop" 
               alt="WalletConnect" class="wallet-icon">
          <div class="text-left">
            <div class="font-semibold dark:text-white">WalletConnect</div>
            <div class="text-sm text-gray-500 dark:text-gray-400">Mobile wallets</div>
          </div>
        </button>

        <button onclick="connectTrust()" class="wallet-option">
          <img src="https://images.pexels.com/photos/730547/pexels-photo-730547.jpeg?auto=compress&cs=tinysrgb&w=80&h=80&fit=crop" 
               alt="Trust Wallet" class="wallet-icon">
          <div class="text-left">
            <div class="font-semibold dark:text-white">Trust Wallet</div>
            <div class="text-sm text-gray-500 dark:text-gray-400">Trust Wallet app</div>
          </div>
        </button>

        <button onclick="connectCoinbase()" class="wallet-option">
          <img src="https://images.pexels.com/photos/844124/pexels-photo-844124.jpeg?auto=compress&cs=tinysrgb&w=80&h=80&fit=crop" 
               alt="Coinbase" class="wallet-icon">
          <div class="text-left">
            <div class="font-semibold dark:text-white">Coinbase</div>
            <div class="text-sm text-gray-500 dark:text-gray-400">Coinbase Wallet</div>
          </div>
        </button>
      </div>
      
      <div class="mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
        <p class="text-sm text-blue-700 dark:text-blue-300">
          📱 <strong>Mobile users:</strong> Use WalletConnect to connect your mobile wallet app.
        </p>
      </div>
    </div>
  </div>

  <!-- How to Buy Modal -->
  <div id="howToBuyModal" class="hidden fixed inset-0 wallet-modal z-50 flex items-center justify-center p-4">
    <div class="bg-white dark:bg-gray-800 rounded-xl p-6 w-full max-w-2xl relative transition-colors duration-300">
      <button onclick="hideHowToBuy()" class="absolute top-4 right-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
        <i class="fas fa-times text-xl"></i>
      </button>
      
      <h3 class="text-2xl font-bold mb-6 dark:text-white text-center">How to Buy $FLUFFI</h3>
      
      <div class="space-y-6">
        <div class="flex items-start gap-4">
          <div class="w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center font-bold">1</div>
          <div>
            <h4 class="font-semibold dark:text-white mb-2">Connect Your Wallet</h4>
            <p class="text-gray-600 dark:text-gray-300">Click "Connect Wallet" and choose your preferred wallet (MetaMask, Trust Wallet, etc.)</p>
          </div>
        </div>
        
        <div class="flex items-start gap-4">
          <div class="w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center font-bold">2</div>
          <div>
            <h4 class="font-semibold dark:text-white mb-2">Enter Purchase Amount</h4>
            <p class="text-gray-600 dark:text-gray-300">Choose USD or ETH and enter the amount you want to invest</p>
          </div>
        </div>
        
        <div class="flex items-start gap-4">
          <div class="w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center font-bold">3</div>
          <div>
            <h4 class="font-semibold dark:text-white mb-2">Add Referral (Optional)</h4>
            <p class="text-gray-600 dark:text-gray-300">Enter a referral wallet address to earn bonus tokens</p>
          </div>
        </div>
        
        <div class="flex items-start gap-4">
          <div class="w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center font-bold">4</div>
          <div>
            <h4 class="font-semibold dark:text-white mb-2">Complete Purchase</h4>
            <p class="text-gray-600 dark:text-gray-300">Click "Buy Now" and confirm the transaction in your wallet</p>
          </div>
        </div>
      </div>
      
      <div class="mt-8 p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg">
        <p class="text-sm text-yellow-700 dark:text-yellow-300">
          <strong>Note:</strong> Make sure you have enough ETH in your wallet to cover gas fees for the transaction.
        </p>
      </div>
    </div>
  </div>

  <script>
    // Global Variables
    let userWalletAddress = null;
    let walletProvider = null;
    let web3Provider = null;
    const TOTAL_STAGES = 15;
    const STAGE_DURATION = 60 * 1000; // 1 minute per stage
    const PRESALE_DURATION = TOTAL_STAGES * STAGE_DURATION;

    // Contract Configuration - REPLACE WITH YOUR ACTUAL CONTRACT
    const CONTRACT_ADDRESS = "0x60A94bc12d0d4F782Fd597e5E1222247CFb7E297"; // Replace with your contract
    const CONTRACT_ABI = [
      {
        "inputs": [{"internalType": "address", "name": "referrer", "type": "address"}],
        "name": "contribute",
        "outputs": [],
        "stateMutability": "payable",
        "type": "function"
      },
      {
        "inputs": [],
        "name": "totalRaised",
        "outputs": [{"internalType": "uint256", "name": "", type": "uint256"}],
        "stateMutability": "view",
        "type": "function"
      }
    ];

    // Timer Functions
    function getPresaleStartTime() {
      let startTime = localStorage.getItem('presaleStartTime');
      if (!startTime) {
        startTime = Date.now().toString();
        localStorage.setItem('presaleStartTime', startTime);
      }
      return parseInt(startTime);
    }

    function updateTimers() {
      const now = Date.now();
      const startTime = getPresaleStartTime();
      const endTime = startTime + PRESALE_DURATION;
      const totalTimeLeft = endTime - now;

      // Calculate stage progress
      const stage = Math.min(
        Math.floor((now - startTime) / STAGE_DURATION),
        TOTAL_STAGES - 1
      );
      const stageEndTime = startTime + ((stage + 1) * STAGE_DURATION);
      const stageLeft = stageEndTime - now;
      const progress = 1 - (stageLeft / STAGE_DURATION);

      // Update displays
      document.getElementById('current-stage').textContent = stage + 1;
      document.getElementById('stageProgressBar').style.width = `${((stage + progress) / TOTAL_STAGES) * 100}%`;

      // Update price
      const price = (0.0001 * Math.pow(1.05, stage)).toFixed(6);
      const priceElement = document.getElementById('currentPrice');
      const nextIncreaseTime = Math.floor(stageLeft / 1000);
      const mins = Math.floor(nextIncreaseTime / 60);
      const secs = nextIncreaseTime % 60;
      
      priceElement.innerHTML = `$${price} <span class="price-tooltip"><i class="fas fa-info-circle text-blue-500 cursor-pointer"></i><span class="tooltip-text"><strong>Price Increase:</strong><br>+5% per stage (every 1 minute)<br>Next increase: ${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}</span></span>`;

      // Update timers
      if (totalTimeLeft <= 0) {
        document.getElementById('presale-timer').innerHTML = "🎉 Presale Ended!";
        document.getElementById('stage-seconds').textContent = "0";
      } else {
        document.getElementById('presale-minutes').textContent = Math.floor(totalTimeLeft / (1000 * 60)).toString().padStart(2, '0');
        document.getElementById('presale-seconds').textContent = Math.floor((totalTimeLeft % (1000 * 60)) / 1000).toString().padStart(2, '0');
        document.getElementById('stage-seconds').textContent = Math.floor(stageLeft / 1000);
      }
    }

    // Theme Functions
    function toggleTheme() {
      document.documentElement.classList.toggle('dark');
      localStorage.setItem('darkMode', document.documentElement.classList.contains('dark'));
      
      // Update chart if it exists
      if (window.tokenChart) {
        const isDark = document.documentElement.classList.contains('dark');
        window.tokenChart.options.plugins.legend.labels.color = isDark ? '#FFFFFF' : '#111827';
        window.tokenChart.update();
      }
    }

    // Modal Functions
    function showWalletModal() {
      document.getElementById('walletModal').classList.remove('hidden');
    }

    function hideWalletModal() {
      document.getElementById('walletModal').classList.add('hidden');
    }

    function showHowToBuy() {
      document.getElementById('howToBuyModal').classList.remove('hidden');
    }

    function hideHowToBuy() {
      document.getElementById('howToBuyModal').classList.add('hidden');
    }

    // Connection Status
    function updateConnectionStatus(connected, address = null) {
      const statusEl = document.getElementById('connectionStatus');
      const textEl = document.getElementById('statusText');
      
      if (connected) {
        statusEl.className = 'connection-status connected';
        textEl.textContent = `Connected: ${address.slice(0, 6)}...${address.slice(-4)}`;
        statusEl.classList.remove('hidden');
      } else {
        statusEl.className = 'connection-status disconnected';
        textEl.textContent = 'Disconnected';
        statusEl.classList.add('hidden');
      }
    }

    // Wallet Connection Functions
    async function connectInjected() {
      try {
        if (!window.ethereum) {
          alert('MetaMask not detected. Please install MetaMask or use a Web3-enabled browser.');
          return;
        }

        // Request account access
        const accounts = await window.ethereum.request({ 
          method: 'eth_requestAccounts' 
        });
        
        if (accounts.length === 0) {
          throw new Error('No accounts found');
        }

        // Create provider
        web3Provider = new ethers.providers.Web3Provider(window.ethereum);
        userWalletAddress = accounts[0];
        
        // Check network (optional - switch to BSC mainnet)
        const network = await web3Provider.getNetwork();
        console.log('Connected to network:', network.name, network.chainId);
        
        updateWalletUI();
        updateConnectionStatus(true, userWalletAddress);
        hideWalletModal();
        
        console.log('✅ Wallet connected successfully:', userWalletAddress);
        
      } catch (error) {
        console.error('❌ Wallet connection failed:', error);
        alert(`Failed to connect wallet: ${error.message}`);
      }
    }

    async function connectWalletConnect() {
      try {
        const isMobile = /Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(navigator.userAgent);
        
        if (isMobile) {
          // Mobile WalletConnect deep linking
          const wcUri = generateWalletConnectURI();
          
          // Try different wallet deep links
          const walletLinks = [
            `metamask://wc?uri=${encodeURIComponent(wcUri)}`,
            `trust://wc?uri=${encodeURIComponent(wcUri)}`,
            `rainbow://wc?uri=${encodeURIComponent(wcUri)}`,
            `https://link.trustwallet.com/wc?uri=${encodeURIComponent(wcUri)}`
          ];
          
          // Show options to user
          const choice = confirm('Open in mobile wallet?\nOK = MetaMask Mobile\nCancel = Trust Wallet');
          const linkIndex = choice ? 0 : 1;
          
          window.location.href = walletLinks[linkIndex];
          
          // Simulate connection for demo (remove in production)
          setTimeout(() => {
            userWalletAddress = '0x1234567890123456789012345678901234567890';
            updateWalletUI();
            updateConnectionStatus(true, userWalletAddress);
            hideWalletModal();
          }, 3000);
          
        } else {
          // Desktop WalletConnect
          if (typeof WalletConnectProvider !== 'undefined') {
            const provider = new WalletConnectProvider.default({
              rpc: {
                1: "https://mainnet.infura.io/v3/YOUR_INFURA_KEY", // Replace with your Infura key
                56: "https://bsc-dataseed.binance.org/"
              },
              chainId: 56
            });

            await provider.enable();
            web3Provider = new ethers.providers.Web3Provider(provider);
            const accounts = await web3Provider.listAccounts();
            userWalletAddress = accounts[0];
            
            updateWalletUI();
            updateConnectionStatus(true, userWalletAddress);
            hideWalletModal();
          } else {
            alert('WalletConnect not available. Please use mobile app or browser wallet.');
          }
        }
      } catch (error) {
        console.error('WalletConnect failed:', error);
        alert('Failed to connect with WalletConnect. Please try again.');
      }
    }

    function generateWalletConnectURI() {
      // This would normally be generated by WalletConnect library
      return 'wc:00e46b69-d0cc-4b3e-b6a2-cee442f97188@1?bridge=https%3A%2F%2Fbridge.walletconnect.org&key=91303dedf64285cbbaf9120f6e9d160a5c8aa3deb67017a3874cd272323f48ae';
    }

    async function connectTrust() {
      const isMobile = /Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(navigator.userAgent);
      
      if (isMobile) {
        // Trust Wallet deep link
        const trustLink = 'trust://';
        window.location.href = trustLink;
        
        // Simulate connection for demo
        setTimeout(() => {
          userWalletAddress = '0x1234567890123456789012345678901234567890';
          updateWalletUI();
          updateConnectionStatus(true, userWalletAddress);
          hideWalletModal();
        }, 2000);
      } else {
        alert('Trust Wallet is primarily a mobile app. Please use on mobile device or try browser wallet.');
      }
    }

    async function connectCoinbase() {
      try {
        // Check if Coinbase Wallet is available
        if (window.ethereum && window.ethereum.isCoinbaseWallet) {
          const accounts = await window.ethereum.request({ 
            method: 'eth_requestAccounts' 
          });
          
          web3Provider = new ethers.providers.Web3Provider(window.ethereum);
          userWalletAddress = accounts[0];
          
          updateWalletUI();
          updateConnectionStatus(true, userWalletAddress);
          hideWalletModal();
        } else {
          alert('Coinbase Wallet not detected. Please install Coinbase Wallet extension.');
        }
      } catch (error) {
        console.error('Coinbase connection failed:', error);
        alert('Failed to connect Coinbase Wallet.');
      }
    }

    function updateWalletUI() {
      if (userWalletAddress) {
        const shortAddress = `${userWalletAddress.slice(0, 6)}...${userWalletAddress.slice(-4)}`;
        document.getElementById('walletButton').classList.add('hidden');
        document.getElementById('walletInfo').classList.remove('hidden');
        document.getElementById('walletAddress').textContent = shortAddress;
        
        // Update referral section
        showReferralUI();
      }
    }

    function disconnectWallet() {
      userWalletAddress = null;
      web3Provider = null;
      walletProvider = null;
      
      document.getElementById('walletButton').classList.remove('hidden');
      document.getElementById('walletInfo').classList.add('hidden');
      updateConnectionStatus(false);
      
      // Reset referral section
      document.getElementById('referralSection').innerHTML = `
        <p class="mb-4 text-gray-600 dark:text-gray-300">Connect your wallet to access your referral link and start earning!</p>
        <button onclick="connectForReferrals()" 
                class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg font-semibold transition-colors">
          Connect Wallet for Referrals
        </button>
      `;
    }

    function connectForReferrals() {
      showWalletModal();
    }

    // Real Buy Function with Smart Contract Integration
    async function buyFluffi() {
      if (!userWalletAddress || !web3Provider) {
        alert('Please connect your wallet first.');
        showWalletModal();
        return;
      }

      const amount = document.getElementById('amountInput').value;
      const currency = document.getElementById('currencySelect').value;
      const ref = document.getElementById('refInput').value;
      
      if (!amount || isNaN(amount) || Number(amount) <= 0) {
        alert('Please enter a valid amount.');
        return;
      }

      const buyButton = document.getElementById('buyButton');
      const originalText = buyButton.textContent;
      buyButton.textContent = '⏳ Processing...';
      buyButton.disabled = true;
      buyButton.classList.add('loading');

      try {
        // Calculate ETH value
        let ethValue;
        if (currency === 'USD') {
          // You should get real ETH price from an API
          const ethPrice = 3000; // $3000 per ETH (replace with real price)
          ethValue = (Number(amount) / ethPrice).toFixed(6);
        } else {
          ethValue = Number(amount).toFixed(6);
        }

        // Validate referral address
        const referralAddress = (ref && ethers.utils.isAddress(ref)) ? 
          ref : '0x0000000000000000000000000000000000000000';

        // Get signer
        const signer = web3Provider.getSigner();
        
        // Create contract instance
        const contract = new ethers.Contract(CONTRACT_ADDRESS, CONTRACT_ABI, signer);
        
        // Estimate gas
        const gasEstimate = await contract.estimateGas.contribute(referralAddress, {
          value: ethers.utils.parseEther(ethValue.toString())
        });
        
        // Add 20% buffer to gas estimate
        const gasLimit = gasEstimate.mul(120).div(100);
        
        // Send transaction
        const tx = await contract.contribute(referralAddress, {
          value: ethers.utils.parseEther(ethValue.toString()),
          gasLimit: gasLimit
        });
        
        console.log('Transaction sent:', tx.hash);
        
        // Wait for confirmation
        const receipt = await tx.wait();
        
        if (receipt.status === 1) {
          alert(`🎉 Purchase successful!\n\nTransaction Hash: ${tx.hash}\n\nTokens will be available for claim after presale ends.`);
          
          // Clear form
          document.getElementById('amountInput').value = '';
          document.getElementById('refInput').value = '';
          
          // Update tokens sold (you might want to fetch this from contract)
          updateTokensSold();
          
        } else {
          throw new Error('Transaction failed');
        }
        
      } catch (error) {
        console.error('Transaction failed:', error);
        
        let errorMessage = 'Transaction failed. ';
        if (error.code === 4001) {
          errorMessage += 'User rejected the transaction.';
        } else if (error.code === -32603) {
          errorMessage += 'Internal error. Please try again.';
        } else if (error.message.includes('insufficient funds')) {
          errorMessage += 'Insufficient funds for transaction.';
        } else {
          errorMessage += error.message || 'Unknown error occurred.';
        }
        
        alert('❌ ' + errorMessage);
      } finally {
        buyButton.textContent = originalText;
        buyButton.disabled = false;
        buyButton.classList.remove('loading');
      }
    }

    // Update tokens sold from contract
    async function updateTokensSold() {
      try {
        if (web3Provider) {
          const contract = new ethers.Contract(CONTRACT_ADDRESS, CONTRACT_ABI, web3Provider);
          const totalRaised = await contract.totalRaised();
          const totalRaisedEth = ethers.utils.formatEther(totalRaised);
          
          // Calculate tokens sold based on current price and total raised
          // This is a simplified calculation - adjust based on your tokenomics
          const currentPrice = 0.0001; // Get current price
          const tokensSold = Math.floor(Number(totalRaisedEth) * 3000 / currentPrice); // Assuming 1 ETH = $3000
          
          document.getElementById('tokensSold').textContent = tokensSold.toLocaleString();
        }
      } catch (error) {
        console.error('Failed to update tokens sold:', error);
      }
    }

    // Staking Function
    function stakeFluffi() {
      const amount = document.getElementById('stakeInput').value;
      if (!amount || isNaN(amount) || Number(amount) <= 0) {
        alert('Please enter a valid amount to stake.');
        return;
      }
      
      if (!userWalletAddress) {
        alert('Please connect your wallet first.');
        showWalletModal();
        return;
      }
      
      alert('Staking feature will be available after token launch!');
    }

    // FAQ Functions
    function toggleFAQ(index) {
      const content = document.getElementById(`faq-content-${index}`);
      const icon = document.getElementById(`faq-icon-${index}`);
      
      if (content.classList.contains('hidden')) {
        content.classList.remove('hidden');
        icon.style.transform = 'rotate(180deg)';
      } else {
        content.classList.add('hidden');
        icon.style.transform = 'rotate(0deg)';
      }
    }

    // Referral Functions
    function showReferralUI() {
      if (!userWalletAddress) return;
      
      const referralLink = `${window.location.href.split('?')[0]}?ref=${userWalletAddress}`;
      
      document.getElementById('referralSection').innerHTML = `
        <div class="space-y-4">
          <div>
            <label class="block mb-2 font-semibold text-gray-800 dark:text-gray-100">Your referral link:</label>
            <div class="flex">
              <input type="text" id="referralLinkInput" 
                     value="${referralLink}" 
                     class="flex-1 p-3 border rounded-l-lg dark:bg-gray-700 dark:border-gray-600 text-black dark:text-white" readonly>
              <button onclick="copyReferralLink()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 rounded-r-lg transition-colors flex items-center gap-2">
                <i class="fas fa-copy"></i>
                Copy
              </button>
            </div>
          </div>
          
          <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg">
            <p class="dark:text-gray-300">👥 Total referrals: <span class="font-bold">0</span></p>
            <p class="dark:text-gray-300">💰 Earnings: <span class="font-bold">0 FLUFFI</span></p>
          </div>
          
          <div>
            <p class="text-sm mb-2 font-semibold text-gray-800 dark:text-gray-100">Share your link:</p>
            <div class="flex space-x-3">
              <button onclick="shareOnTwitter()" class="flex items-center justify-center bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm transition-colors gap-2">
                <i class="fab fa-twitter"></i>
                Twitter
              </button>
              <button onclick="shareOnTelegram()" class="flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm transition-colors gap-2">
                <i class="fab fa-telegram"></i>
                Telegram
              </button>
            </div>
          </div>
        </div>
      `;
    }

    function copyReferralLink() {
      const input = document.getElementById('referralLinkInput');
      input.select();
      document.execCommand('copy');
      
      // Show feedback
      const button = event.target.closest('button');
      const originalText = button.innerHTML;
      button.innerHTML = '<i class="fas fa-check"></i> Copied!';
      setTimeout(() => {
        button.innerHTML = originalText;
      }, 2000);
    }

    function shareOnTwitter() {
      const link = document.getElementById('referralLinkInput').value;
      const text = encodeURIComponent('Join $FLUFFI presale! 🚀 Use my referral link for bonus tokens:');
      const url = encodeURIComponent(link);
      window.open(`https://twitter.com/intent/tweet?text=${text}&url=${url}&hashtags=FluffiArmy`, '_blank');
    }

    function shareOnTelegram() {
      const link = encodeURIComponent(document.getElementById('referralLinkInput').value);
      const text = encodeURIComponent('Check out $FLUFFI presale with my referral link!');
      window.open(`https://t.me/share/url?url=${link}&text=${text}`, '_blank');
    }

    // Chart Initialization
    function initChart() {
      const ctx = document.getElementById('tokenChart').getContext('2d');
      
      function getLabelColor() {
        return document.documentElement.classList.contains('dark') ? '#FFFFFF' : '#111827';
      }

      const chartConfig = {
        type: 'doughnut',
        data: {
          labels: ['Presale (40%)', 'Liquidity (30%)', 'Staking (20%)', 'Marketing (5%)', 'Team (5%)'],
          datasets: [{
            data: [40, 30, 20, 5, 5],
            backgroundColor: [
              '#10B981', // Green
              '#3B82F6', // Blue
              '#F59E0B', // Yellow
              '#EF4444', // Red
              '#8B5CF6'  // Purple
            ],
            borderWidth: 2,
            borderColor: document.documentElement.classList.contains('dark') ? '#374151' : '#ffffff'
          }]
        },
        options: {
          cutout: '65%',
          plugins: {
            legend: {
              position: 'bottom',
              labels: {
                color: getLabelColor(),
                font: {
                  size: 14,
                  family: "'Inter', sans-serif"
                },
                padding: 20,
              }
            }
          },
          responsive: true,
          maintainAspectRatio: false
        }
      };

      window.tokenChart = new Chart(ctx, chartConfig);
    }

    // Initialize everything when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize dark mode from localStorage
      if (localStorage.getItem('darkMode') === 'true') {
        document.documentElement.classList.add('dark');
      }

      // Initialize chart
      initChart();

      // Start timers
      updateTimers();
      setInterval(updateTimers, 1000);

      // Check if wallet is already connected
      if (window.ethereum) {
        window.ethereum.request({ method: 'eth_accounts' })
          .then(accounts => {
            if (accounts.length > 0) {
              web3Provider = new ethers.providers.Web3Provider(window.ethereum);
              userWalletAddress = accounts[0];
              updateWalletUI();
              updateConnectionStatus(true, userWalletAddress);
            }
          })
          .catch(console.error);
      }

      // Update tokens sold on load
      updateTokensSold();
    });

    // Handle wallet account changes
    if (window.ethereum) {
      window.ethereum.on('accountsChanged', function(accounts) {
        if (accounts.length === 0) {
          disconnectWallet();
        } else {
          userWalletAddress = accounts[0];
          updateWalletUI();
          updateConnectionStatus(true, userWalletAddress);
        }
      });

      window.ethereum.on('chainChanged', function(chainId) {
        // Reload page when chain changes
        window.location.reload();
      });
    }
  </script>
</body>
</html>
